{"version":3,"file":"ol-tilecache.umd.min.js","sources":["../node_modules/@babel/runtime/helpers/typeof.js","../src/util.js","../src/tile-url-function.js","../src/index.js"],"sourcesContent":["function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","/**\n * This file is part of ol-tilecache package.\n * @module ol-tilecache\n * @license MIT\n * @author Vladimir Vershinin\n */\n\n/**\n * Left zero pad.\n *\n * @param {string | number} num\n * @param {number} places\n * @returns {string}\n */\nexport function zeroPad (num, places) {\n  const zero = places - num.toString().length + 1\n\n  return (new Array(parseInt(zero > 0 && zero, 10)).join(\"0\") + num)\n    .toString()\n    .slice(-places)\n}\n\n/**\n * The % operator in JavaScript returns the remainder of a / b, but differs from\n * some other languages in that the result will have the same sign as the\n * dividend. For example, -1 % 8 == -1, whereas in some other languages\n * (such as Python) the result would be 7. This function emulates the more\n * correct modulo behavior, which is useful for certain applications such as\n * calculating an offset index in a circular list.\n *\n * @param {number} a The dividend.\n * @param {number} b The divisor.\n * @return {number} a % b where the result is between 0 and b (either 0 <= x < b\n *     or b < x <= 0, depending on the sign of b).\n * @link https://closure-library.googlecode.com/git-history/docs/local_closure_goog_math_math.js.source.html#line73\n */\nexport function modulo (a, b) {\n  const m = a % b\n\n  return (m * b) < 0 ? m + b : m\n}\n","/**\n * This file is part of ol-tilecache package.\n * @module ol-tilecache\n * @license MIT\n * @author Vladimir Vershinin\n */\nimport { createXYZ } from 'ol/tilegrid'\nimport { modulo, zeroPad } from './util'\n\nconst zRegEx = /{z}/g\nconst zPadRegEx = /{0z}/g\nconst xRegEx = /{x\\d?}/g\nconst yRegEx = /{y\\d?}/g\nconst dashYRegEx = /{-y\\d?}/g\n\n/**\n * Basic create factory.\n *\n * @param {string} url Url template\n * @param {TileGrid} [tileGrid] Tile grid.\n * @returns {function(tileCoord: TileCoord)}\n * @static\n * @public\n */\nexport function createTileUrlFunction (url, tileGrid = createXYZ()) {\n  return createTileUrlFunctionFromTemplates(expandUrl(url), tileGrid)\n}\n\n/**\n * Creates tile URL function from single template.\n *\n * @param {string} template Source url\n * @param {TileGrid} [tileGrid] Tile grid.\n * @returns {function(tileCoord: TileCoord)}\n * @private\n */\nexport function createTileUrlFunctionFromTemplate (template, tileGrid = createXYZ()) {\n  return (\n    /**\n     * @param {TileCoord} tileCoord Tile Coordinate.\n     * @return {string | undefined} Tile URL.\n     */\n    function (tileCoord) {\n      if (tileCoord != null) {\n        return template.replace(zRegEx, zoomReplacer(tileCoord[0]))\n          .replace(zPadRegEx, zoomReplacer(tileCoord[0], true))\n          .replace(xRegEx, coordReplacer(tileCoord[1]))\n          .replace(yRegEx, coordReplacer(tileCoord[2]))\n          .replace(dashYRegEx, function (part) {\n            const z = tileCoord[0]\n            const range = tileGrid.getFullTileRange(z)\n            if (!range) throw new Error('The {-y} placeholder requires a tile grid with extent.')\n            const y = range.getHeight() - tileCoord[2] - 1\n\n            return coordReplacer(y)(part)\n          })\n      }\n    })\n}\n\n/**\n * Creates tile URL function from multiple templates.\n *\n * @param {string[]} templates Url templates\n * @param {TileGrid} [tileGrid] Tile grid.\n * @returns {function(tileCoord: TileCoord)}\n * @private\n */\nexport function createTileUrlFunctionFromTemplates (templates, tileGrid = createXYZ()) {\n  return createTileUrlFunctionFromTileUrlFunctions(\n    templates.map(tileUrlFunction => createTileUrlFunctionFromTemplate(tileUrlFunction, tileGrid)),\n  )\n}\n\n/**\n * @param zoom\n * @param pad\n * @returns {function}\n * @private\n */\nfunction zoomReplacer (zoom, pad) {\n  return function () {\n    return pad ? zeroPad(zoom, 2) : zoom.toString()\n  }\n}\n\n/**\n * @param coord\n * @returns {function}\n * @private\n */\nfunction coordReplacer (coord) {\n  return function (part) {\n    const match = part.match(/\\d/)\n\n    if (match) {\n      return zeroPad(coord, 9).slice((match[0] - 1) * 3, match[0] * 3)\n    }\n\n    return coord.toString()\n  }\n}\n\n/**\n * @param {string} url\n * @returns {Array.<string>}\n * @private\n */\nfunction expandUrl (url) {\n  const urls = []\n  const match = /{(\\d)-(\\d)}/.exec(url) ||\n    /{([a-z])-([a-z])}/.exec(url)\n\n  if (match) {\n    const startCharCode = match[1].charCodeAt(0)\n    const stopCharCode = match[2].charCodeAt(0)\n\n    for (let charCode = startCharCode; charCode <= stopCharCode; ++charCode) {\n      urls.push(url.replace(match[0], String.fromCharCode(charCode)))\n    }\n  } else {\n    urls.push(url)\n  }\n\n  return urls\n}\n\n/**\n * @param {Array.<function(tileCoord: TileCoord)>} tileUrlFunctions\n * @returns {function(tileCoord: TileCoord)}\n * @private\n */\nfunction createTileUrlFunctionFromTileUrlFunctions (tileUrlFunctions) {\n  if (tileUrlFunctions.length === 1) {\n    return tileUrlFunctions[0]\n  }\n\n  return (\n    /**\n     * @param {TileCoord} tileCoord Tile Coordinate.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {Projection} projection Projection.\n     * @return {string | undefined} Tile URL.\n     */\n    function (tileCoord, pixelRatio, projection) {\n      if (tileCoord != null) {\n        const h = (tileCoord[1] << tileCoord[0]) + tileCoord[2]\n        const index = modulo(h, tileUrlFunctions.length)\n\n        return tileUrlFunctions[index](tileCoord, pixelRatio, projection)\n      }\n    })\n}\n","/**\n * This file is part of ol-tilecache package.\n * @module ol-tilecache\n * @license MIT\n * @author Vladimir Vershinin\n */\nimport {\n  createTileUrlFunction,\n  createTileUrlFunctionFromTemplate,\n  createTileUrlFunctionFromTemplates,\n} from './tile-url-function'\n\nexport {\n  createTileUrlFunction,\n  createTileUrlFunctionFromTemplate,\n  createTileUrlFunctionFromTemplates\n}\n\n// for backward compatibility\nif (typeof window !== 'undefined' && typeof window.ol === 'object') {\n  window.ol.tileCacheUrlFn = {\n    createTileUrlFunction,\n    createTileUrlFunctionFromTemplate,\n    createTileUrlFunctionFromTemplates,\n  }\n}\n"],"names":["_typeof","obj","Symbol","iterator","module","constructor","prototype","zeroPad","num","places","zero","toString","length","Array","parseInt","join","slice","zRegEx","zPadRegEx","xRegEx","yRegEx","dashYRegEx","createTileUrlFunction","url","tileGrid","createXYZ","createTileUrlFunctionFromTemplates","expandUrl","createTileUrlFunctionFromTemplate","template","tileCoord","replace","zoomReplacer","coordReplacer","part","z","range","getFullTileRange","Error","getHeight","templates","createTileUrlFunctionFromTileUrlFunctions","map","tileUrlFunction","zoom","pad","coord","match","urls","exec","startCharCode","charCodeAt","stopCharCode","charCode","push","String","fromCharCode","tileUrlFunctions","pixelRatio","projection","h","index","a","b","m","window","ol","tileCacheUrlFn"],"mappings":";;;;;;;;;8fAAA,SAASA,EAAQC,GAaf,MAVsB,mBAAXC,QAAoD,iBAApBA,OAAOC,SAChDC,UAAiBJ,EAAU,SAAiBC,GAC1C,cAAcA,GAGhBG,UAAiBJ,EAAU,SAAiBC,GAC1C,OAAOA,GAAyB,mBAAXC,QAAyBD,EAAII,cAAgBH,QAAUD,IAAQC,OAAOI,UAAY,gBAAkBL,GAItHD,EAAQC,GAGjBG,UAAiBJ,KCFV,SAASO,EAASC,EAAKC,OACtBC,EAAOD,EAASD,EAAIG,WAAWC,OAAS,SAEtC,IAAIC,MAAMC,SAASJ,EAAO,GAAKA,EAAM,KAAKK,KAAK,KAAOP,GAC3DG,WACAK,OAAOP,GCVZ,IAAMQ,EAAS,OACTC,EAAY,QACZC,EAAS,UACTC,EAAS,UACTC,EAAa,WAWZ,SAASC,EAAuBC,OAAKC,yDAAWC,qBAC9CC,EAAmCC,EAAUJ,GAAMC,GAWrD,SAASI,EAAmCC,OAAUL,yDAAWC,8BAM1DK,MACS,MAAbA,SACKD,EAASE,QAAQd,EAAQe,EAAaF,EAAU,KACpDC,QAAQb,EAAWc,EAAaF,EAAU,IAAI,IAC9CC,QAAQZ,EAAQc,EAAcH,EAAU,KACxCC,QAAQX,EAAQa,EAAcH,EAAU,KACxCC,QAAQV,GAAY,SAAUa,OACvBC,EAAIL,EAAU,GACdM,EAAQZ,EAASa,iBAAiBF,OACnCC,EAAO,MAAM,IAAIE,MAAM,iEAGrBL,EAFGG,EAAMG,YAAcT,EAAU,GAAK,EAEtCG,CAAiBC,OAc7B,SAASR,EAAoCc,OAAWhB,yDAAWC,qBACjEgB,EACLD,EAAUE,KAAI,SAAAC,UAAmBf,EAAkCe,EAAiBnB,OAUxF,SAASQ,EAAcY,EAAMC,UACpB,kBACEA,EAAMtC,EAAQqC,EAAM,GAAKA,EAAKjC,YASzC,SAASsB,EAAea,UACf,SAAUZ,OACTa,EAAQb,EAAKa,MAAM,aAErBA,EACKxC,EAAQuC,EAAO,GAAG9B,MAAuB,GAAhB+B,EAAM,GAAK,GAAmB,EAAXA,EAAM,IAGpDD,EAAMnC,YASjB,SAASgB,EAAWJ,OACZyB,EAAO,GACPD,EAAQ,cAAcE,KAAK1B,IAC/B,oBAAoB0B,KAAK1B,MAEvBwB,UACIG,EAAgBH,EAAM,GAAGI,WAAW,GACpCC,EAAeL,EAAM,GAAGI,WAAW,GAEhCE,EAAWH,EAAeG,GAAYD,IAAgBC,EAC7DL,EAAKM,KAAK/B,EAAIQ,QAAQgB,EAAM,GAAIQ,OAAOC,aAAaH,UAGtDL,EAAKM,KAAK/B,UAGLyB,EAQT,SAASP,EAA2CgB,UAClB,IAA5BA,EAAiB7C,OACZ6C,EAAiB,YAUd3B,EAAW4B,EAAYC,MACd,MAAb7B,EAAmB,KACf8B,GAAK9B,EAAU,IAAMA,EAAU,IAAMA,EAAU,GAC/C+B,GD/GUC,EC+GKF,ED/GFG,EC+GKN,EAAiB7C,QD9GzCoD,EAAIF,EAAIC,GAEFA,EAAK,EAAIC,EAAID,EAAIC,UC8GhBP,EAAiBI,GAAO/B,EAAW4B,EAAYC,GDjHvD,IAAiBG,EAAGC,EACnBC,GElBc,oBAAXC,QAA+C,WAArBjE,EAAOiE,OAAOC,MACjDD,OAAOC,GAAGC,eAAiB,CACzB7C,sBAAAA,EACAM,kCAAAA,EACAF,mCAAAA"}