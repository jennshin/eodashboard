{"remainingRequest":"/Volumes/WD_Elements_25A1_Media/Google Drive/___Public/__2021-Hackathon-EOD/eodash-staging/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/WD_Elements_25A1_Media/Google Drive/___Public/__2021-Hackathon-EOD/eodash-staging/app/src/components/Map.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/WD_Elements_25A1_Media/Google Drive/___Public/__2021-Hackathon-EOD/eodash-staging/app/src/components/Map.vue","mtime":1624532486000},{"path":"/Volumes/WD_Elements_25A1_Media/Google Drive/___Public/__2021-Hackathon-EOD/eodash-staging/app/node_modules/cache-loader/dist/cjs.js","mtime":1624878747000},{"path":"/Volumes/WD_Elements_25A1_Media/Google Drive/___Public/__2021-Hackathon-EOD/eodash-staging/app/node_modules/babel-loader/lib/index.js","mtime":1624878747000},{"path":"/Volumes/WD_Elements_25A1_Media/Google Drive/___Public/__2021-Hackathon-EOD/eodash-staging/app/node_modules/cache-loader/dist/cjs.js","mtime":1624878747000},{"path":"/Volumes/WD_Elements_25A1_Media/Google Drive/___Public/__2021-Hackathon-EOD/eodash-staging/app/node_modules/vue-loader/lib/index.js","mtime":1624878753000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgbWFwR2V0dGVycywKICBtYXBTdGF0ZSwKfSBmcm9tICd2dWV4JzsKCmltcG9ydCB7CiAgZ2VvSnNvbiwgUG9pbnQsIERpdkljb24sIGZlYXR1cmVHcm91cCwKfSBmcm9tICdsZWFmbGV0JzsKaW1wb3J0IHsKICBMTWFwLCBMVGlsZUxheWVyLCBMV01TVGlsZUxheWVyLCBMR2VvSnNvbiwgTE1hcmtlciwgTEljb24sIExUb29sdGlwLAogIExDb250cm9sTGF5ZXJzLCBMQ29udHJvbEF0dHJpYnV0aW9uLCBMQ29udHJvbFpvb20sCn0gZnJvbSAndnVlMi1sZWFmbGV0JzsKaW1wb3J0IFZ1ZTJMZWFmbGV0TWFya2VyQ2x1c3RlciBmcm9tICd2dWUyLWxlYWZsZXQtbWFya2VyY2x1c3Rlcic7CmltcG9ydCAnbGVhZmxldC9kaXN0L2xlYWZsZXQuY3NzJzsKaW1wb3J0ICdsZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvZGlzdC9NYXJrZXJDbHVzdGVyLmNzcyc7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgaW1wb3J0L25vLWV4dHJhbmVvdXMtZGVwZW5kZW5jaWVzCmltcG9ydCAnbGVhZmxldC5tYXJrZXJjbHVzdGVyL2Rpc3QvTWFya2VyQ2x1c3Rlci5EZWZhdWx0LmNzcyc7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgaW1wb3J0L25vLWV4dHJhbmVvdXMtZGVwZW5kZW5jaWVzCmltcG9ydCAnbGVhZmxldC1tb3VzZS1wb3NpdGlvbic7CgppbXBvcnQgY291bnRyaWVzIGZyb20gJ0AvYXNzZXRzL2NvdW50cmllcy5qc29uJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBMTWFwLAogICAgTFRpbGVMYXllciwKICAgIExXTVNUaWxlTGF5ZXIsCiAgICBMR2VvSnNvbiwKICAgIExNYXJrZXIsCiAgICBMSWNvbiwKICAgIExUb29sdGlwLAogICAgTENvbnRyb2xMYXllcnMsCiAgICBMQ29udHJvbEF0dHJpYnV0aW9uLAogICAgTENvbnRyb2xab29tLAogICAgJ2wtbWFya2VyLWNsdXN0ZXInOiBWdWUyTGVhZmxldE1hcmtlckNsdXN0ZXIsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbWFwOiBudWxsLAogICAgICBtaW5NYXBab29tOiAzLAogICAgICB6b29tOiAzLAogICAgICBtYXhNYXBab29tOiAxNCwKICAgICAgY2VudGVyOiBbNTUsIDEwXSwKICAgICAgYm91bmRzOiBudWxsLAogICAgICBjdXJyZW50U2VsZWN0ZWQ6IG51bGwsCiAgICAgIGN1cnJlbnRTZWxlY3RlZEluZGV4OiBudWxsLAogICAgICBzdWJBb2k6IG51bGwsCiAgICAgIGRlZmF1bHRNYXBPcHRpb25zOiB7CiAgICAgICAgYXR0cmlidXRpb25Db250cm9sOiBmYWxzZSwKICAgICAgICB6b29tQ29udHJvbDogZmFsc2UsCiAgICAgIH0sCiAgICAgIG9wYWNpdHlUZXJyYWluOiBbMV0sCiAgICAgIG9wYWNpdHlPdmVybGF5OiBbMCwgMCwgMCwgMCwgMCwgMCwgMC40LCAwLjQsIDAuOCwgMC44LCAwLjksIDAuOSwgMC45LCAwLjksIDAuOSwgMC45LCAwLjldLAogICAgICBvcGFjaXR5Q291bnRyaWVzOiBbMSwgMSwgMSwgMSwgMC43LCAwLjcsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKCdmZWF0dXJlcycsIFsnZ2V0R3JvdXBlZEZlYXR1cmVzJ10pLAogICAgLi4ubWFwU3RhdGUoJ2NvbmZpZycsIFsnYXBwQ29uZmlnJywgJ2Jhc2VDb25maWcnXSksCiAgICBiYXNlTGF5ZXJzKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlQ29uZmlnLmJhc2VMYXllcnNMZWZ0TWFwOwogICAgfSwKICAgIG92ZXJsYXlMYXllcnMoKSB7CiAgICAgIHJldHVybiB0aGlzLmJhc2VDb25maWcub3ZlcmxheUxheWVyc0xlZnRNYXA7CiAgICB9LAogICAgY291bnRyaWVzSnNvbigpIHsKICAgICAgcmV0dXJuIGNvdW50cmllczsKICAgIH0sCiAgICBjbHVzdGVyT3B0aW9ucygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBtYXhDbHVzdGVyUmFkaXVzOiA0MCwKICAgICAgICBhbmltYXRlOiBmYWxzZSwKICAgICAgICAvLyB6b29tVG9Cb3VuZHNPbkNsaWNrOiBmYWxzZSwKICAgICAgICBpY29uQ3JlYXRlRnVuY3Rpb246IGZ1bmN0aW9uIChjbHVzdGVyKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgZnVuYy1uYW1lcwogICAgICAgICAgLy8gbGVmdCBhcyBkZWZhdWx0CiAgICAgICAgICBsZXQgc2VsQ2x1c3RlciA9IG51bGw7CiAgICAgICAgICBpZiAodGhpcy5jdXJyZW50U2VsZWN0ZWQgIT09IG51bGwgJiYgdGhpcy4kcmVmcy5jbHVzdGVyTGF5ZXIpIHsKICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRNYXJrZXIgPSB0aGlzLiRyZWZzLm1hcmtlcnMuZmluZCgKICAgICAgICAgICAgICAoaXRlbSkgPT4gaXRlbS5uYW1lID09PSB0aGlzLmN1cnJlbnRTZWxlY3RlZCwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKHNlbGVjdGVkTWFya2VyKSB7CiAgICAgICAgICAgICAgc2VsQ2x1c3RlciA9IHRoaXMuJHJlZnMuY2x1c3RlckxheWVyLm1hcE9iamVjdC5nZXRWaXNpYmxlUGFyZW50KAogICAgICAgICAgICAgICAgc2VsZWN0ZWRNYXJrZXIubWFwT2JqZWN0LAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIC8vIG1vZGlmaWVkIHNlbGVjdGVkIGNsdXN0ZXIgc3R5bGUKICAgICAgICAgIGNvbnN0IHNlbCA9IHNlbENsdXN0ZXIgIT09IG51bGwgPyBjbHVzdGVyLl9sZWFmbGV0X2lkID09PSBzZWxDbHVzdGVyLl9sZWFmbGV0X2lkIDogZmFsc2U7CiAgICAgICAgICBjb25zdCBzZWxlY3RlZENsYXNzID0gc2VsID8gJyBtYXJrZXItY2x1c3Rlci1zZWxlY3RlZCcgOiAnJzsKICAgICAgICAgIGxldCBpY29uU2l6ZSA9IG51bGw7CiAgICAgICAgICBpZiAoc2VsKSB7CiAgICAgICAgICAgIGljb25TaXplID0gbmV3IFBvaW50KDQ4LCA0OCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpY29uU2l6ZSA9IG5ldyBQb2ludCg0MCwgNDApOwogICAgICAgICAgfQogICAgICAgICAgY29uc3QgY2hpbGRDb3VudCA9IGNsdXN0ZXIuZ2V0Q2hpbGRDb3VudCgpOwogICAgICAgICAgcmV0dXJuIG5ldyBEaXZJY29uKHsKICAgICAgICAgICAgaHRtbDogYDxkaXYgY2xhc3M9IiR7c2VsZWN0ZWRDbGFzc30iPjxzcGFuPiR7Y2hpbGRDb3VudH08L3NwYW4+PC9kaXY+YCwKICAgICAgICAgICAgY2xhc3NOYW1lOiBgbWFya2VyLWNsdXN0ZXIgJHtzZWxlY3RlZENsYXNzfWAsCiAgICAgICAgICAgIGljb25TaXplLAogICAgICAgICAgfSk7CiAgICAgICAgfS5iaW5kKHRoaXMpLAogICAgICAgIHBvbHlnb25PcHRpb25zOiB7CiAgICAgICAgICBmaWxsQ29sb3I6IHRoaXMuJHZ1ZXRpZnkudGhlbWUudGhlbWVzLmxpZ2h0LnByaW1hcnksCiAgICAgICAgICBjb2xvcjogdGhpcy4kdnVldGlmeS50aGVtZS50aGVtZXMubGlnaHQucHJpbWFyeSwKICAgICAgICAgIHdlaWdodDogMC41LAogICAgICAgICAgb3BhY2l0eTogMSwKICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjMsCiAgICAgICAgICBkYXNoQXJyYXk6IDQsCiAgICAgICAgfSwKICAgICAgfTsKICAgIH0sCiAgICBpbmRpY2F0b3JzRGVmaW5pdGlvbjogKCkgPT4gdGhpcy5iYXNlQ29uZmlnLmluZGljYXRvcnNEZWZpbml0aW9uLAogICAgY291bnRyaWVzU3R5bGUoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgY29sb3I6ICcjYTJhMmEyJywKICAgICAgICB3ZWlnaHQ6IDEsCiAgICAgICAgZmlsbENvbG9yOiAnI2ZmZicsCiAgICAgICAgb3BhY2l0eTogdGhpcy5vcGFjaXR5Q291bnRyaWVzW3RoaXMuem9vbV0sCiAgICAgICAgZmlsbE9wYWNpdHk6IHRoaXMub3BhY2l0eUNvdW50cmllc1t0aGlzLnpvb21dLAogICAgICB9OwogICAgfSwKICAgIHN1YkFvaVN0eWxlKCkgewogICAgICBsZXQgY3VycmVudEluZGljYXRvcjsKICAgICAgbGV0IGZpbGxDb2xvcjsKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmluZGljYXRvcnMuc2VsZWN0ZWRJbmRpY2F0b3IpIHsKICAgICAgICBjdXJyZW50SW5kaWNhdG9yID0gdGhpcy4kc3RvcmUuc3RhdGUuaW5kaWNhdG9ycy5zZWxlY3RlZEluZGljYXRvcjsKICAgICAgICBmaWxsQ29sb3IgPSB0aGlzLmdldENvbG9yKGN1cnJlbnRJbmRpY2F0b3IpOwogICAgICB9IGVsc2UgewogICAgICAgIGZpbGxDb2xvciA9IHRoaXMuZ2V0SW5kaWNhdG9yQ29sb3IoJycpOwogICAgICB9CiAgICAgIHJldHVybiB7CiAgICAgICAgY29sb3I6ICcjZmZmJywKICAgICAgICB3ZWlnaHQ6IDEsCiAgICAgICAgZmlsbENvbG9yLAogICAgICAgIG9wYWNpdHk6IDEsCiAgICAgICAgZmlsbE9wYWNpdHk6IDAuNSwKICAgICAgfTsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICBjb25zdCBsYXllckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5sZWFmbGV0LWNvbnRyb2wtbGF5ZXJzLXRvZ2dsZScpOwogICAgICBsYXllckJ1dHRvbi5pbm5lckhUTUwgPSBgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iJHt0aGlzLmFwcENvbmZpZy5icmFuZGluZy5wcmltYXJ5Q29sb3J9IiB3aWR0aD0iMzJweCIgaGVpZ2h0PSIzMnB4Ij48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTExLjk5IDE4LjU0bC03LjM3LTUuNzNMMyAxNC4wN2w5IDcgOS03LTEuNjMtMS4yNy03LjM4IDUuNzR6TTEyIDE2bDcuMzYtNS43M0wyMSA5bC05LTctOSA3IDEuNjMgMS4yN0wxMiAxNnoiLz48L3N2Zz5gOwoKICAgICAgdGhpcy5tYXAgPSB0aGlzLiRyZWZzLm1hcC5tYXBPYmplY3Q7CgogICAgICB0aGlzLiRyZWZzLnN1YmFvaUxheWVyLm1hcE9iamVjdC5iaW5kVG9vbHRpcCgnUmVmZXJlbmNlIGFyZWEnLCB7CiAgICAgICAgZGlyZWN0aW9uOiAndG9wJywKICAgICAgfSk7CgogICAgICAvLyB1cGRhdGUgbGVhZmxldCBjb250cm9scwogICAgICBMLmNvbnRyb2wubW91c2VQb3NpdGlvbih7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWYKICAgICAgICBlbXB0eVN0cmluZzogJycsCiAgICAgICAgZm9ybWF0dGVyOiAobG9uLCBsYXQpID0+IGAke2xvbi50b0ZpeGVkKDMpfSwgJHtsYXQudG9GaXhlZCgzKX1gLAogICAgICAgIHBvc2l0aW9uOiAnYm90dG9tcmlnaHQnLAogICAgICB9KS5hZGRUbyh0aGlzLm1hcCk7CiAgICAgIC8vIGhpZGUgYXR0cmlidXRpb24gdW5kZXIgaWNvbgogICAgICB0aGlzLm1hcC5hdHRyaWJ1dGlvbkNvbnRyb2wuX3VwZGF0ZSA9IGZ1bmN0aW9uICgpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgIGNvbnN0IGF0dHJpYnMgPSBbXTsKICAgICAgICBjb25zdCBrayA9IE9iamVjdC5rZXlzKHRoaXMuX2F0dHJpYnV0aW9ucyk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBray5sZW5ndGg7IGkgKz0gMSkgewogICAgICAgICAgaWYgKHRoaXMuX2F0dHJpYnV0aW9uc1tra1tpXV0pIHsKICAgICAgICAgICAgYXR0cmlicy5wdXNoKGtrW2ldKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY29uc3QgcHJlZml4QW5kQXR0cmlicyA9IFtdOwogICAgICAgIGlmICh0aGlzLm9wdGlvbnMucHJlZml4KSB7CiAgICAgICAgICBwcmVmaXhBbmRBdHRyaWJzLnB1c2godGhpcy5vcHRpb25zLnByZWZpeCk7CiAgICAgICAgfQogICAgICAgIGlmIChhdHRyaWJzLmxlbmd0aCkgewogICAgICAgICAgcHJlZml4QW5kQXR0cmlicy5wdXNoKGF0dHJpYnMuam9pbignLCAnKSk7CiAgICAgICAgfQogICAgICAgIHRoaXMuX2NvbnRhaW5lci5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz0nYXR0cmlidXRpb24tYm9keSc+JHtwcmVmaXhBbmRBdHRyaWJzLmpvaW4oJyB8ICcpfTwvZGl2PjxkaXYgY2xhc3M9J2F0dHJpYnV0aW9uLWljb24nPuKEuTwvZGl2PmA7CiAgICAgIH07CiAgICAgIHRoaXMubWFwLmF0dHJpYnV0aW9uQ29udHJvbC5fdXBkYXRlKCk7CiAgICAgIHRoaXMub25SZXNpemUoKTsKICAgIH0pOwogICAgdGhpcy4kc3RvcmUuc3Vic2NyaWJlKChtdXRhdGlvbikgPT4gewogICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2luZGljYXRvcnMvSU5ESUNBVE9SX0xPQURfRklOSVNIRUQnKSB7CiAgICAgICAgaWYgKG11dGF0aW9uLnBheWxvYWQgIT09IG51bGwgJiYgbXV0YXRpb24ucGF5bG9hZC5hb2kgIT09IG51bGwpIHsKICAgICAgICAgIHRoaXMuY3VycmVudFNlbGVjdGVkID0gdGhpcy5nZXRMb2NhdGlvbkNvZGUobXV0YXRpb24ucGF5bG9hZCk7CiAgICAgICAgICBpZiAobXV0YXRpb24ucGF5bG9hZC5zdWJBb2kpIHsKICAgICAgICAgICAgdGhpcy5zdWJBb2kgPSBtdXRhdGlvbi5wYXlsb2FkLnN1YkFvaTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5jdXJyZW50U2VsZWN0ZWQgPSBudWxsOwogICAgICAgICAgdGhpcy5zdWJBb2kgPSB7CiAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICAgIGZlYXR1cmVzOiBbXSwKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIHRoaXMucmVzZXRDbHVzdGVyTGF5ZXIoKTsKICAgICAgfSBlbHNlIGlmIChtdXRhdGlvbi50eXBlID09PSAnZmVhdHVyZXMvU0VUX0ZFQVRVUkVfRklMVEVSJykgewogICAgICAgIGlmIChPYmplY3Qua2V5cyhtdXRhdGlvbi5wYXlsb2FkKS5pbmNsdWRlcygnaW5jbHVkZUFyY2hpdmVkJykgJiYgT2JqZWN0LmtleXMobXV0YXRpb24ucGF5bG9hZCkubGVuZ3RoID09PSAxKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCBmZWF0dXJlcyA9IHRoaXMuZ2V0R3JvdXBlZEZlYXR1cmVzOwogICAgICAgIGNvbnN0IGZlYXR1cmVzT25NYXAgPSBmZWF0dXJlcy5maWx0ZXIoKGYpID0+IGYubGF0bG5nKTsKICAgICAgICBpZiAoZmVhdHVyZXNPbk1hcC5sZW5ndGggPiAwKSB7CiAgICAgICAgICBjb25zdCBtYXhab29tRml0ID0gODsKICAgICAgICAgIGlmIChmZWF0dXJlc09uTWFwLmxlbmd0aCA9PT0gMSAmJiBmZWF0dXJlc09uTWFwWzBdLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LnN1YkFvaQogICAgICAgICAgJiYgZmVhdHVyZXNPbk1hcFswXS5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5zdWJBb2kuZmVhdHVyZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgICAgY29uc3QgYm91bmRzID0gZ2VvSnNvbigKICAgICAgICAgICAgICAgIGZlYXR1cmVzT25NYXBbMF0ucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3Quc3ViQW9pLAogICAgICAgICAgICAgICkuZ2V0Qm91bmRzKCk7CiAgICAgICAgICAgICAgdGhpcy5tYXAuZml0Qm91bmRzKGJvdW5kcywgewogICAgICAgICAgICAgICAgcGFkZGluZzogWzI1LCAyNV0sCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgICAgIGNvbnN0IG1hcmtlcnMgPSB0aGlzLiRyZWZzLm1hcmtlcnMubWFwKChjb21wb25lbnQpID0+IGNvbXBvbmVudC5tYXBPYmplY3QpOwogICAgICAgICAgICAgIGNvbnN0IGR1bW15RnRyR3JvdXAgPSBmZWF0dXJlR3JvdXAobWFya2Vycyk7CiAgICAgICAgICAgICAgdGhpcy5tYXAuZml0Qm91bmRzKGR1bW15RnRyR3JvdXAuZ2V0Qm91bmRzKCksIHsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IFsyNSwgMjVdLAogICAgICAgICAgICAgICAgbWF4Wm9vbTogbWF4Wm9vbUZpdCwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNlbGVjdEluZGljYXRvcihmZWF0dXJlKSB7CiAgICAgIGNvbnN0IHsgaW5kaWNhdG9yT2JqZWN0IH0gPSBmZWF0dXJlLnByb3BlcnRpZXM7CiAgICAgIGlmICghaW5kaWNhdG9yT2JqZWN0LmR1bW15RmVhdHVyZSkgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnaW5kaWNhdG9ycy9TRVRfU0VMRUNURURfSU5ESUNBVE9SJywgaW5kaWNhdG9yT2JqZWN0KTsKICAgICAgICBjb25zdCBxdWVyeSA9IHsgLi4udGhpcy4kcm91dGUucXVlcnkgfTsKICAgICAgICBkZWxldGUgcXVlcnkuc2Vuc29yOwogICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKHsgcXVlcnkgfSkuY2F0Y2goKCkgPT4ge30pOwogICAgICB9CiAgICB9LAogICAgZ2V0Q29sb3IoaW5kT2JqKSB7CiAgICAgIGxldCBjb2xvckNvZGU7CiAgICAgIGlmIChpbmRPYmopIHsKICAgICAgICBpZiAoaW5kT2JqLnVwZGF0ZUZyZXF1ZW5jeSAmJiBpbmRPYmoudXBkYXRlRnJlcXVlbmN5LnRvTG93ZXJDYXNlKCkgPT09ICdhcmNoaXZlZCcpIHsKICAgICAgICAgIGNvbG9yQ29kZSA9ICdncmV5JzsKICAgICAgICB9IGVsc2UgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChpbmRPYmosICdsYXN0Q29sb3JDb2RlJykKICAgICAgICAgICYmICFbJycsICcvJ10uaW5jbHVkZXMoaW5kT2JqLmxhc3RDb2xvckNvZGUpKSB7CiAgICAgICAgICBjb2xvckNvZGUgPSBpbmRPYmoubGFzdENvbG9yQ29kZTsKICAgICAgICB9IGVsc2UgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChpbmRPYmosICdpbmRpY2F0b3InKQogICAgICAgICAgJiYgWydOMScsICdOMWEnLCAnTjFiJywgJ04zYicsICdFMTBhMycsICdFMTBhOCcsICdFMTBhOScsICdFMTJiJywgJ0MxJywgJ0MyJywgJ0MzJ10KICAgICAgICAgICAgLmluY2x1ZGVzKGluZE9iai5pbmRpY2F0b3IpKSB7CiAgICAgICAgICBjb2xvckNvZGUgPSAnQkxVRSc7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmdldEluZGljYXRvckNvbG9yKGNvbG9yQ29kZSk7CiAgICB9LAogICAgZm9ybWF0TGFiZWwoZmVhdHVyZSkgewogICAgICBsZXQgbGFiZWwgPSAnKGNvbWluZyBzb29uKSc7CiAgICAgIGlmIChmZWF0dXJlKSB7CiAgICAgICAgY29uc3QgeyBpbmRpY2F0b3JPYmplY3QgfSA9IGZlYXR1cmUucHJvcGVydGllczsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGluZGljYXRvck9iamVjdCwgJ2xhc3RJbmRpY2F0b3JWYWx1ZScpIHx8IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChpbmRpY2F0b3JPYmplY3QsICdsYXN0TWVhc3VyZW1lbnQnKSkgewogICAgICAgICAgbGFiZWwgPSAnTGF0ZXN0IHZhbHVlOiAnOwogICAgICAgICAgY29uc3QgaW5kVmFsID0gaW5kaWNhdG9yT2JqZWN0Lmxhc3RJbmRpY2F0b3JWYWx1ZSAhPT0gJycgPyBpbmRpY2F0b3JPYmplY3QubGFzdEluZGljYXRvclZhbHVlIDogaW5kaWNhdG9yT2JqZWN0Lmxhc3RNZWFzdXJlbWVudDsKICAgICAgICAgIGlmIChbJ0UxMGExJywgJ0UxMGE1J10uaW5jbHVkZXMoaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvcikpIHsKICAgICAgICAgICAgY29uc3QgcGVyY1ZhbCA9IE51bWJlcigoaW5kVmFsICogMTAwKS50b1ByZWNpc2lvbig0KSk7CiAgICAgICAgICAgIGlmIChwZXJjVmFsID4gMCkgewogICAgICAgICAgICAgIGxhYmVsICs9IGArJHtwZXJjVmFsfSVgOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGxhYmVsICs9IGAke3BlcmNWYWx9JWA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAoWydFMTBhMycsICdFMTBhOCcsICdFMTBhOScsICdONGMnXS5pbmNsdWRlcyhpbmRpY2F0b3JPYmplY3QuaW5kaWNhdG9yKSkgewogICAgICAgICAgICBsYWJlbCArPSAnbXVsdGlwbGUnOwogICAgICAgICAgfSBlbHNlIGlmIChbJ0UxMGE2JywgJ0UxMGE3J10uaW5jbHVkZXMoaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvcikpIHsKICAgICAgICAgICAgY29uc3QgbmV3SW5kVmFsID0gTnVtYmVyKGluZGljYXRvck9iamVjdC5sYXN0TWVhc3VyZW1lbnQpLnRvUHJlY2lzaW9uKDQpOwogICAgICAgICAgICBsYWJlbCArPSBgJHtuZXdJbmRWYWx9JWA7CiAgICAgICAgICB9IGVsc2UgaWYgKFsnTjEnLCAnTjNiJywgJ04xYicsICdFMTJiJywgJ0MxJywgJ0MyJywgJ0MzJ10uaW5jbHVkZXMoaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvcikpIHsKICAgICAgICAgICAgbGFiZWwgPSAnJzsKICAgICAgICAgIH0gZWxzZSBpZiAoaW5kVmFsID09PSBudWxsKSB7CiAgICAgICAgICAgIGxhYmVsID0gbnVsbDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxhYmVsICs9IGluZFZhbDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIE92ZXJ3cml0ZSBsYWJlbCBpZiBhcmNoaXZlZAogICAgICAgIGlmIChpbmRpY2F0b3JPYmplY3QudXBkYXRlRnJlcXVlbmN5ICYmIGluZGljYXRvck9iamVjdC51cGRhdGVGcmVxdWVuY3kudG9Mb3dlckNhc2UoKSA9PT0gJ2FyY2hpdmVkJykgewogICAgICAgICAgbGFiZWwgPSAnQXJjaGl2ZWQnOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGxhYmVsOwogICAgfSwKICAgIHJlc2V0Q2x1c3RlckxheWVyKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5jbHVzdGVyTGF5ZXIpIHsKICAgICAgICB0aGlzLiRyZWZzLmNsdXN0ZXJMYXllci5tYXBPYmplY3QucmVmcmVzaENsdXN0ZXJzKCk7CiAgICAgIH0KICAgIH0sCiAgICB6b29tVXBkYXRlZCh6b29tKSB7CiAgICAgIHRoaXMuem9vbSA9IHpvb207CiAgICAgIHRoaXMub25SZXNpemUoKTsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMucmVzZXRDbHVzdGVyTGF5ZXIoKTsKICAgICAgfSk7CiAgICB9LAogICAgY2VudGVyVXBkYXRlZChjZW50ZXIpIHsKICAgICAgdGhpcy5jZW50ZXIgPSBjZW50ZXI7CiAgICAgIHRoaXMub25SZXNpemUoKTsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMucmVzZXRDbHVzdGVyTGF5ZXIoKTsKICAgICAgfSk7CiAgICB9LAogICAgYm91bmRzVXBkYXRlZChib3VuZHMpIHsKICAgICAgdGhpcy5ib3VuZHMgPSBib3VuZHM7CiAgICAgIHRoaXMub25SZXNpemUoKTsKICAgIH0sCiAgICBvblJlc2l6ZSgpIHsKICAgICAgLy8gdG8gZml4IHBhbmVsIHNpemUgZm9yIHJlZmVyZW5jZSBpbWFnZSB3aW5kb3cKICAgICAgaWYgKHRoaXMubWFwKSB7CiAgICAgICAgdGhpcy5tYXAuX29uUmVzaXplKCk7CiAgICAgIH0KICAgIH0sCiAgICBsYXllck9wdGlvbnModGltZSwgc291cmNlT3B0aW9uc09iaikgewogICAgICBjb25zdCBhZGRpdGlvbmFsU2V0dGluZ3MgPSB7CiAgICAgICAgbWluWm9vbTogc291cmNlT3B0aW9uc09iai5taW5ab29tLAogICAgICAgIG1heFpvb206IHNvdXJjZU9wdGlvbnNPYmoubWF4Wm9vbSwKICAgICAgICBtaW5OYXRpdmVab29tOiBzb3VyY2VPcHRpb25zT2JqLm1pbk5hdGl2ZVpvb20sCiAgICAgICAgbWF4TmF0aXZlWm9vbTogc291cmNlT3B0aW9uc09iai5tYXhOYXRpdmVab29tLAogICAgICB9OwogICAgICBpZiAodGltZSAhPT0gbnVsbCkgewogICAgICAgIC8vIHRpbWUgYXMgaXMgZ2V0cyBhdXRvbWF0aWNhbGx5IGluamVjdGVkIHRvIFdNUyBxdWVyeSBPUiB4eXogdXJsIHt0aW1lfSB0ZW1wbGF0ZQogICAgICAgIGFkZGl0aW9uYWxTZXR0aW5ncy50aW1lID0gc291cmNlT3B0aW9uc09iai5kYXRlRm9ybWF0RnVuY3Rpb24KICAgICAgICAgID8gc291cmNlT3B0aW9uc09iai5kYXRlRm9ybWF0RnVuY3Rpb24odGltZSkKICAgICAgICAgIDogdGltZTsKICAgICAgfQogICAgICByZXR1cm4gYWRkaXRpb25hbFNldHRpbmdzOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Map.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoIA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Map.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <l-map\n    ref=\"map\"\n    style=\"height: 100%; width: 100%; background: #cad2d3; z-index: 1\"\n    :options=\"defaultMapOptions\"\n    :zoom=\"zoom\"\n    :center=\"center\"\n    :maxZoom=\"maxMapZoom\"\n    :minMapZoom=\"minMapZoom\"\n    @update:zoom=\"zoomUpdated\"\n    @update:center=\"centerUpdated\"\n    @update:bounds=\"boundsUpdated\"\n  >\n    <l-control-attribution position=\"bottomright\" prefix=''></l-control-attribution>\n    <l-control-layers position=\"topright\"></l-control-layers>\n    <l-control-zoom position=\"topright\"></l-control-zoom>\n    <LTileLayer\n      v-for=\"layer in baseLayers.filter(b => b.protocol === 'xyz')\"\n      :key=\"layer.name\"\n      v-bind=\"layer\"\n      layer-type=\"base\"\n      :opacity=\"opacityTerrain[zoom]\"\n      :options=\"layerOptions(null, layer)\"\n    >\n    </LTileLayer>\n    <LWMSTileLayer\n      v-for=\"layer in baseLayers.filter(b => b.protocol === 'WMS')\"\n      :key=\"layer.name\"\n      v-bind=\"layer\"\n      :options=\"layerOptions(null, layer)\"\n      layer-type=\"base\"\n    >\n    </LWMSTileLayer>\n    <l-geo-json\n    :geojson=\"countriesJson\"\n    :optionsStyle=\"countriesStyle\"\n    name=\"Country vectors\"\n    layer-type=\"overlay\"\n    >\n    </l-geo-json>\n    <l-geo-json\n    ref=\"subaoiLayer\"\n    :geojson=\"subAoi\"\n    :optionsStyle=\"subAoiStyle\">\n    </l-geo-json>\n    <LTileLayer\n      v-for=\"layer in overlayLayers.filter(b => b.protocol === 'xyz')\"\n      :key=\"layer.name\"\n      v-bind=\"layer\"\n      layer-type=\"overlay\"\n      :opacity=\"opacityOverlay[zoom]\"\n      :options=\"layerOptions(null, layer)\"\n    >\n    </LTileLayer>\n    <LWMSTileLayer\n      v-for=\"layer in overlayLayers.filter(b => b.protocol === 'WMS')\"\n      v-bind=\"layer\"\n      :key=\"layer.name\"\n      :options=\"layerOptions(null, layer)\"\n      :opacity=\"opacityOverlay[zoom]\"\n      layer-type=\"overlay\"\n    >\n    </LWMSTileLayer>\n    <l-marker-cluster ref=\"clusterLayer\" :options=\"clusterOptions\">\n      <l-marker v-for=\"(feature) in getGroupedFeatures.filter((f) => f.latlng)\"\n        :key=\"feature.id\"\n        ref=\"markers\"\n        :lat-lng=\"feature.latlng\"\n        :name='`${getLocationCode(feature.properties.indicatorObject)}`'\n        @click=\"selectIndicator(feature)\"\n      >\n        <l-icon\n          :icon-anchor=\"currentSelected === getLocationCode(feature.properties.indicatorObject)\n            ? [18, 18]\n            : [14, 14]\"\n          style=\"outline: none;\"\n        >\n          <div\n            :style=\"`display: flex; align-items: center;\n              justify-content: center;\n              border-radius: 50%;\n              border: 2px ${currentSelected ===\n                getLocationCode(feature.properties.indicatorObject)\n                  ? 'dashed var(--v-primary-base)'\n                  : 'solid white'};\n              width: ${currentSelected ===\n                getLocationCode(feature.properties.indicatorObject) ? '36px' : '28px'};\n              height: ${currentSelected ===\n                getLocationCode(feature.properties.indicatorObject) ? '36px' : '28px'};\n              background-color: ${getColor(feature.properties.indicatorObject)}`\"\n          >\n              <v-icon\n                color=\"white\"\n                class=\"pa-1\"\n                icon-url=\"/test\"\n                :small=\"currentSelected !== getLocationCode(feature.properties.indicatorObject)\"\n              >\n                {{ baseConfig.indicatorClassesIcons[baseConfig\n                    .indicatorsDefinition[feature.properties.indicatorObject.indicator].class]\n                    ? baseConfig.indicatorClassesIcons[baseConfig\n                      .indicatorsDefinition[feature.properties.indicatorObject.indicator].class]\n                    : 'mdi-lightbulb-on-outline'}}\n              </v-icon>\n          </div>\n        </l-icon>\n        <l-tooltip class=\"tooltip text-center\" :options=\"{ direction: 'top' }\">\n          <p class=\"ma-0\">\n            <strong>{{ feature.properties.indicatorObject.city }}</strong>\n          </p>\n            <p class=\"ma-0\" v-if=\"baseConfig.indicatorsDefinition[\n              feature.properties.indicatorObject.indicator\n              ].indicatorOverwrite\">\n              <strong>{{ baseConfig.indicatorsDefinition[\n                feature.properties.indicatorObject.indicator\n              ].indicatorOverwrite}}\n              </strong>\n            </p>\n            <p class=\"ma-0\" v-else>\n              <strong>{{ feature.properties.indicatorObject.description }}</strong>\n            </p>\n            <p\n              class=\"ma-0\"\n            >\n              {{ formatLabel(feature) }}\n            </p>\n        </l-tooltip>\n      </l-marker>\n    </l-marker-cluster>\n  </l-map>\n</template>\n\n<script>\nimport {\n  mapGetters,\n  mapState,\n} from 'vuex';\n\nimport {\n  geoJson, Point, DivIcon, featureGroup,\n} from 'leaflet';\nimport {\n  LMap, LTileLayer, LWMSTileLayer, LGeoJson, LMarker, LIcon, LTooltip,\n  LControlLayers, LControlAttribution, LControlZoom,\n} from 'vue2-leaflet';\nimport Vue2LeafletMarkerCluster from 'vue2-leaflet-markercluster';\nimport 'leaflet/dist/leaflet.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.css'; // eslint-disable-line import/no-extraneous-dependencies\nimport 'leaflet.markercluster/dist/MarkerCluster.Default.css'; // eslint-disable-line import/no-extraneous-dependencies\nimport 'leaflet-mouse-position';\n\nimport countries from '@/assets/countries.json';\n\nexport default {\n  components: {\n    LMap,\n    LTileLayer,\n    LWMSTileLayer,\n    LGeoJson,\n    LMarker,\n    LIcon,\n    LTooltip,\n    LControlLayers,\n    LControlAttribution,\n    LControlZoom,\n    'l-marker-cluster': Vue2LeafletMarkerCluster,\n  },\n  data() {\n    return {\n      map: null,\n      minMapZoom: 3,\n      zoom: 3,\n      maxMapZoom: 14,\n      center: [55, 10],\n      bounds: null,\n      currentSelected: null,\n      currentSelectedIndex: null,\n      subAoi: null,\n      defaultMapOptions: {\n        attributionControl: false,\n        zoomControl: false,\n      },\n      opacityTerrain: [1],\n      opacityOverlay: [0, 0, 0, 0, 0, 0, 0.4, 0.4, 0.8, 0.8, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9],\n      opacityCountries: [1, 1, 1, 1, 0.7, 0.7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    };\n  },\n  computed: {\n    ...mapGetters('features', ['getGroupedFeatures']),\n    ...mapState('config', ['appConfig', 'baseConfig']),\n    baseLayers() {\n      return this.baseConfig.baseLayersLeftMap;\n    },\n    overlayLayers() {\n      return this.baseConfig.overlayLayersLeftMap;\n    },\n    countriesJson() {\n      return countries;\n    },\n    clusterOptions() {\n      return {\n        maxClusterRadius: 40,\n        animate: false,\n        // zoomToBoundsOnClick: false,\n        iconCreateFunction: function (cluster) { // eslint-disable-line func-names\n          // left as default\n          let selCluster = null;\n          if (this.currentSelected !== null && this.$refs.clusterLayer) {\n            const selectedMarker = this.$refs.markers.find(\n              (item) => item.name === this.currentSelected,\n            );\n            if (selectedMarker) {\n              selCluster = this.$refs.clusterLayer.mapObject.getVisibleParent(\n                selectedMarker.mapObject,\n              );\n            }\n          }\n          // modified selected cluster style\n          const sel = selCluster !== null ? cluster._leaflet_id === selCluster._leaflet_id : false;\n          const selectedClass = sel ? ' marker-cluster-selected' : '';\n          let iconSize = null;\n          if (sel) {\n            iconSize = new Point(48, 48);\n          } else {\n            iconSize = new Point(40, 40);\n          }\n          const childCount = cluster.getChildCount();\n          return new DivIcon({\n            html: `<div class=\"${selectedClass}\"><span>${childCount}</span></div>`,\n            className: `marker-cluster ${selectedClass}`,\n            iconSize,\n          });\n        }.bind(this),\n        polygonOptions: {\n          fillColor: this.$vuetify.theme.themes.light.primary,\n          color: this.$vuetify.theme.themes.light.primary,\n          weight: 0.5,\n          opacity: 1,\n          fillOpacity: 0.3,\n          dashArray: 4,\n        },\n      };\n    },\n    indicatorsDefinition: () => this.baseConfig.indicatorsDefinition,\n    countriesStyle() {\n      return {\n        color: '#a2a2a2',\n        weight: 1,\n        fillColor: '#fff',\n        opacity: this.opacityCountries[this.zoom],\n        fillOpacity: this.opacityCountries[this.zoom],\n      };\n    },\n    subAoiStyle() {\n      let currentIndicator;\n      let fillColor;\n      if (this.$store.state.indicators.selectedIndicator) {\n        currentIndicator = this.$store.state.indicators.selectedIndicator;\n        fillColor = this.getColor(currentIndicator);\n      } else {\n        fillColor = this.getIndicatorColor('');\n      }\n      return {\n        color: '#fff',\n        weight: 1,\n        fillColor,\n        opacity: 1,\n        fillOpacity: 0.5,\n      };\n    },\n  },\n  mounted() {\n    this.$nextTick(() => {\n      const layerButton = document.querySelector('.leaflet-control-layers-toggle');\n      layerButton.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"${this.appConfig.branding.primaryColor}\" width=\"32px\" height=\"32px\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M11.99 18.54l-7.37-5.73L3 14.07l9 7 9-7-1.63-1.27-7.38 5.74zM12 16l7.36-5.73L21 9l-9-7-9 7 1.63 1.27L12 16z\"/></svg>`;\n\n      this.map = this.$refs.map.mapObject;\n\n      this.$refs.subaoiLayer.mapObject.bindTooltip('Reference area', {\n        direction: 'top',\n      });\n\n      // update leaflet controls\n      L.control.mousePosition({ // eslint-disable-line no-undef\n        emptyString: '',\n        formatter: (lon, lat) => `${lon.toFixed(3)}, ${lat.toFixed(3)}`,\n        position: 'bottomright',\n      }).addTo(this.map);\n      // hide attribution under icon\n      this.map.attributionControl._update = function () { // eslint-disable-line\n        const attribs = [];\n        const kk = Object.keys(this._attributions);\n        for (let i = 0; i < kk.length; i += 1) {\n          if (this._attributions[kk[i]]) {\n            attribs.push(kk[i]);\n          }\n        }\n        const prefixAndAttribs = [];\n        if (this.options.prefix) {\n          prefixAndAttribs.push(this.options.prefix);\n        }\n        if (attribs.length) {\n          prefixAndAttribs.push(attribs.join(', '));\n        }\n        this._container.innerHTML = `<div class='attribution-body'>${prefixAndAttribs.join(' | ')}</div><div class='attribution-icon'>ℹ</div>`;\n      };\n      this.map.attributionControl._update();\n      this.onResize();\n    });\n    this.$store.subscribe((mutation) => {\n      if (mutation.type === 'indicators/INDICATOR_LOAD_FINISHED') {\n        if (mutation.payload !== null && mutation.payload.aoi !== null) {\n          this.currentSelected = this.getLocationCode(mutation.payload);\n          if (mutation.payload.subAoi) {\n            this.subAoi = mutation.payload.subAoi;\n          }\n        } else {\n          this.currentSelected = null;\n          this.subAoi = {\n            type: 'FeatureCollection',\n            features: [],\n          };\n        }\n        this.resetClusterLayer();\n      } else if (mutation.type === 'features/SET_FEATURE_FILTER') {\n        if (Object.keys(mutation.payload).includes('includeArchived') && Object.keys(mutation.payload).length === 1) {\n          return;\n        }\n\n        const features = this.getGroupedFeatures;\n        const featuresOnMap = features.filter((f) => f.latlng);\n        if (featuresOnMap.length > 0) {\n          const maxZoomFit = 8;\n          if (featuresOnMap.length === 1 && featuresOnMap[0].properties.indicatorObject.subAoi\n          && featuresOnMap[0].properties.indicatorObject.subAoi.features.length > 0) {\n            this.$nextTick(() => {\n              const bounds = geoJson(\n                featuresOnMap[0].properties.indicatorObject.subAoi,\n              ).getBounds();\n              this.map.fitBounds(bounds, {\n                padding: [25, 25],\n              });\n            });\n          } else {\n            this.$nextTick(() => {\n              const markers = this.$refs.markers.map((component) => component.mapObject);\n              const dummyFtrGroup = featureGroup(markers);\n              this.map.fitBounds(dummyFtrGroup.getBounds(), {\n                padding: [25, 25],\n                maxZoom: maxZoomFit,\n              });\n            });\n          }\n        }\n      }\n    });\n  },\n  methods: {\n    selectIndicator(feature) {\n      const { indicatorObject } = feature.properties;\n      if (!indicatorObject.dummyFeature) {\n        this.$store.commit('indicators/SET_SELECTED_INDICATOR', indicatorObject);\n        const query = { ...this.$route.query };\n        delete query.sensor;\n        this.$router.replace({ query }).catch(() => {});\n      }\n    },\n    getColor(indObj) {\n      let colorCode;\n      if (indObj) {\n        if (indObj.updateFrequency && indObj.updateFrequency.toLowerCase() === 'archived') {\n          colorCode = 'grey';\n        } else if (Object.prototype.hasOwnProperty.call(indObj, 'lastColorCode')\n          && !['', '/'].includes(indObj.lastColorCode)) {\n          colorCode = indObj.lastColorCode;\n        } else if (Object.prototype.hasOwnProperty.call(indObj, 'indicator')\n          && ['N1', 'N1a', 'N1b', 'N3b', 'E10a3', 'E10a8', 'E10a9', 'E12b', 'C1', 'C2', 'C3']\n            .includes(indObj.indicator)) {\n          colorCode = 'BLUE';\n        }\n      }\n      return this.getIndicatorColor(colorCode);\n    },\n    formatLabel(feature) {\n      let label = '(coming soon)';\n      if (feature) {\n        const { indicatorObject } = feature.properties;\n        if (Object.prototype.hasOwnProperty.call(indicatorObject, 'lastIndicatorValue') || Object.prototype.hasOwnProperty.call(indicatorObject, 'lastMeasurement')) {\n          label = 'Latest value: ';\n          const indVal = indicatorObject.lastIndicatorValue !== '' ? indicatorObject.lastIndicatorValue : indicatorObject.lastMeasurement;\n          if (['E10a1', 'E10a5'].includes(indicatorObject.indicator)) {\n            const percVal = Number((indVal * 100).toPrecision(4));\n            if (percVal > 0) {\n              label += `+${percVal}%`;\n            } else {\n              label += `${percVal}%`;\n            }\n          } else if (['E10a3', 'E10a8', 'E10a9', 'N4c'].includes(indicatorObject.indicator)) {\n            label += 'multiple';\n          } else if (['E10a6', 'E10a7'].includes(indicatorObject.indicator)) {\n            const newIndVal = Number(indicatorObject.lastMeasurement).toPrecision(4);\n            label += `${newIndVal}%`;\n          } else if (['N1', 'N3b', 'N1b', 'E12b', 'C1', 'C2', 'C3'].includes(indicatorObject.indicator)) {\n            label = '';\n          } else if (indVal === null) {\n            label = null;\n          } else {\n            label += indVal;\n          }\n        }\n\n        // Overwrite label if archived\n        if (indicatorObject.updateFrequency && indicatorObject.updateFrequency.toLowerCase() === 'archived') {\n          label = 'Archived';\n        }\n      }\n\n      return label;\n    },\n    resetClusterLayer() {\n      if (this.$refs.clusterLayer) {\n        this.$refs.clusterLayer.mapObject.refreshClusters();\n      }\n    },\n    zoomUpdated(zoom) {\n      this.zoom = zoom;\n      this.onResize();\n      this.$nextTick(() => {\n        this.resetClusterLayer();\n      });\n    },\n    centerUpdated(center) {\n      this.center = center;\n      this.onResize();\n      this.$nextTick(() => {\n        this.resetClusterLayer();\n      });\n    },\n    boundsUpdated(bounds) {\n      this.bounds = bounds;\n      this.onResize();\n    },\n    onResize() {\n      // to fix panel size for reference image window\n      if (this.map) {\n        this.map._onResize();\n      }\n    },\n    layerOptions(time, sourceOptionsObj) {\n      const additionalSettings = {\n        minZoom: sourceOptionsObj.minZoom,\n        maxZoom: sourceOptionsObj.maxZoom,\n        minNativeZoom: sourceOptionsObj.minNativeZoom,\n        maxNativeZoom: sourceOptionsObj.maxNativeZoom,\n      };\n      if (time !== null) {\n        // time as is gets automatically injected to WMS query OR xyz url {time} template\n        additionalSettings.time = sourceOptionsObj.dateFormatFunction\n          ? sourceOptionsObj.dateFormatFunction(time)\n          : time;\n      }\n      return additionalSettings;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep .leaflet-tooltip-top {\n  background: #00000099;\n  border-radius: 3px;\n  color: #fff;\n  pointer-events: none;\n  white-space: nowrap;\n  border: none;\n  &:before {\n    border-top-color: #00000099;\n  }\n}\n::v-deep .marker-cluster {\n  // TO-DO find a way how to get the primary color into this\n  // background-color: rgba(var(--primary-less));\n  background-color: rgba(#003247, 0.5);\n  div {\n    background-color: var(--v-primary-base);\n    span {\n      color: white;\n    }\n    &.marker-cluster-selected {\n      margin-left: 3px;\n      margin-top: 3px;\n      width: 38px;\n      height: 38px;\n      border-radius: 19px;\n      & span {\n        line-height: 38px;\n        font-size: 14px;\n      }\n    }\n  }\n  &.marker-cluster-selected {\n    border: 2px var(--v-primary-base) dashed;\n  }\n}\n::v-deep .leaflet-control-attribution:active :not(.attribution-icon),\n::v-deep .leaflet-control-attribution:hover :not(.attribution-icon),\n::v-deep .leaflet-control-attribution .attribution-icon {\n  display: inline-block;\n}\n::v-deep .leaflet-control-attribution :not(.attribution-icon),\n::v-deep .leaflet-control-attribution:active .attribution-icon,\n::v-deep .leaflet-control-attribution:hover .attribution-icon {\n  display: none;\n}\n::v-deep .attribution-icon {\n  font-size: 1.2em;\n  margin: 1px;\n}\n::v-deep .leaflet-control-mouseposition {\n  background-color: rgba(255, 255, 255, 0.8);\n  transform: translate3d(-8px, 32px, 0);\n  padding: 2px 4px;\n}\n::v-deep .leaflet-bar a, ::v-deep .leaflet-control-attribution {\n  color: var(--v-primary-base) !important;\n}\n::v-deep .leaflet-control-layers-toggle {\n  background-image: none;\n  svg {\n    width: 100%;\n    height: 100%;\n  }\n}\n</style>\n"]}]}