{"remainingRequest":"/Users/8ps/Downloads/eodash-staging/app/node_modules/thread-loader/dist/cjs.js!/Users/8ps/Downloads/eodash-staging/app/node_modules/babel-loader/lib/index.js!/Users/8ps/Downloads/eodash-staging/app/src/store/modules/features.js","dependencies":[{"path":"/Users/8ps/Downloads/eodash-staging/app/src/store/modules/features.js","mtime":1624532486000},{"path":"/Users/8ps/Downloads/eodash-staging/app/node_modules/cache-loader/dist/cjs.js","mtime":1624878747000},{"path":"/Users/8ps/Downloads/eodash-staging/app/node_modules/thread-loader/dist/cjs.js","mtime":1624878747000},{"path":"/Users/8ps/Downloads/eodash-staging/app/node_modules/babel-loader/lib/index.js","mtime":1624878747000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9Vc2Vycy84cHMvRG93bmxvYWRzL2VvZGFzaC1zdGFnaW5nL2FwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvOHBzL0Rvd25sb2Fkcy9lb2Rhc2gtc3RhZ2luZy9hcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIi9Vc2Vycy84cHMvRG93bmxvYWRzL2VvZGFzaC1zdGFnaW5nL2FwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZsYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5lbnRyaWVzLmpzIjsKCi8qIGVzbGludCBuby1zaGFkb3c6IFsiZXJyb3IiLCB7ICJhbGxvdyI6IFsic3RhdGUiLCAiZ2V0dGVycyJdIH1dICovCmltcG9ydCB7IFdrdCB9IGZyb20gJ3dpY2tldCc7CmltcG9ydCB7IGxhdExuZyB9IGZyb20gJ2xlYWZsZXQnOwppbXBvcnQgY291bnRyaWVzSnNvbiBmcm9tICdAL2Fzc2V0cy9jb3VudHJpZXMuanNvbic7CnZhciBnbG9iYWxJZENvdW50ZXIgPSAwOwp2YXIgc3RhdGUgPSB7CiAgYWxsRmVhdHVyZXM6IFtdLAogIGZlYXR1cmVGaWx0ZXJzOiB7CiAgICBjb3VudHJpZXM6IFtdLAogICAgaW5kaWNhdG9yczogW10sCiAgICBpbmNsdWRlQXJjaGl2ZWQ6IGZhbHNlCiAgfSwKICBzZWxlY3RlZEFyZWE6IG51bGwsCiAgcmVzdWx0c0NvdW50OiB7CiAgICBlY29ub21pYzogMCwKICAgIGFncmljdWx0dXJlOiAwLAogICAgZW52aXJvbm1lbnQ6IDAKICB9Cn07CnZhciBnZXR0ZXJzID0gewogIGdldENvdW50cmllczogZnVuY3Rpb24gZ2V0Q291bnRyaWVzKHN0YXRlKSB7CiAgICByZXR1cm4gX3RvQ29uc3VtYWJsZUFycmF5KG5ldyBTZXQoW3N0YXRlLmFsbEZlYXR1cmVzLmZpbHRlcihmdW5jdGlvbiAoZikgewogICAgICByZXR1cm4gc3RhdGUuZmVhdHVyZUZpbHRlcnMuaW5kaWNhdG9ycy5sZW5ndGggPiAwID8gc3RhdGUuZmVhdHVyZUZpbHRlcnMuaW5kaWNhdG9ycy5pbmNsdWRlcyhmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvcikgOiB0cnVlOwogICAgfSkubWFwKGZ1bmN0aW9uIChmKSB7CiAgICAgIHJldHVybiBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmNvdW50cnk7CiAgICB9KV0uZmxhdCgyKSkpLnNvcnQoKTsKICB9LAogIGdldEluZGljYXRvcnM6IGZ1bmN0aW9uIGdldEluZGljYXRvcnMoc3RhdGUsIF8sIHJvb3RTdGF0ZSkgewogICAgdmFyIGluZGljYXRvcnMgPSBfdG9Db25zdW1hYmxlQXJyYXkobmV3IFNldChbc3RhdGUuYWxsRmVhdHVyZXMuZmlsdGVyKGZ1bmN0aW9uIChmKSB7CiAgICAgIHZhciBmaWx0ZXJlZDsKCiAgICAgIGlmIChzdGF0ZS5mZWF0dXJlRmlsdGVycy5jb3VudHJpZXMubGVuZ3RoID4gMCkgewogICAgICAgIGlmIChBcnJheS5pc0FycmF5KGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuY291bnRyeSkpIHsKICAgICAgICAgIGZpbHRlcmVkID0gZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5jb3VudHJ5LnNvbWUoZnVuY3Rpb24gKGkpIHsKICAgICAgICAgICAgcmV0dXJuIHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmNvdW50cmllcy5pbmNsdWRlcyhpKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmaWx0ZXJlZCA9IHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmNvdW50cmllcy5pbmNsdWRlcyhmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmNvdW50cnkpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICghc3RhdGUuZmVhdHVyZUZpbHRlcnMuaW5jbHVkZUFyY2hpdmVkKSB7CiAgICAgICAgZmlsdGVyZWQgPSBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmRlc2NyaXB0aW9uICYmICFmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmRlc2NyaXB0aW9uLmluY2x1ZGVzKCcoYXJjaGl2ZWQpJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmlsdGVyZWQgPSB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmlsdGVyZWQ7CiAgICB9KS5tYXAoZnVuY3Rpb24gKGYpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBhcmNoaXZlZDogZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5kZXNjcmlwdGlvbiAmJiBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmRlc2NyaXB0aW9uLmluY2x1ZGVzKCcoYXJjaGl2ZWQpJyksCiAgICAgICAgY29kZTogZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5pbmRpY2F0b3IsCiAgICAgICAgaW5kaWNhdG9yOiBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmRlc2NyaXB0aW9uLAogICAgICAgIGNsYXNzOiByb290U3RhdGUuY29uZmlnLmJhc2VDb25maWcuaW5kaWNhdG9yc0RlZmluaXRpb25bZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5pbmRpY2F0b3JdLmNsYXNzLAogICAgICAgIGluZGljYXRvck92ZXJ3cml0ZTogcm9vdFN0YXRlLmNvbmZpZy5iYXNlQ29uZmlnLmluZGljYXRvcnNEZWZpbml0aW9uW2YucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuaW5kaWNhdG9yXS5pbmRpY2F0b3JPdmVyd3JpdGUKICAgICAgfTsKICAgIH0pXS5mbGF0KDIpKSkuc29ydCgpOwoKICAgIHJldHVybiBpbmRpY2F0b3JzOwogIH0sCiAgZ2V0Q291bnRyeUl0ZW1zOiBmdW5jdGlvbiBnZXRDb3VudHJ5SXRlbXMoc3RhdGUsIGdldHRlcnNHKSB7CiAgICByZXR1cm4gZ2V0dGVyc0cuZ2V0Q291bnRyaWVzLmZpbHRlcihmdW5jdGlvbiAoYykgewogICAgICByZXR1cm4gYyAhPT0gJ2FsbCc7CiAgICB9KS5tYXAoZnVuY3Rpb24gKGMpIHsKICAgICAgdmFyIGl0ZW0gPSBjb3VudHJpZXNKc29uLmZlYXR1cmVzLmZpbmQoZnVuY3Rpb24gKGYpIHsKICAgICAgICByZXR1cm4gZi5wcm9wZXJ0aWVzLmFscGhhMiA9PT0gYzsKICAgICAgfSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgY29kZTogYywKICAgICAgICBuYW1lOiBpdGVtID8gaXRlbS5wcm9wZXJ0aWVzLm5hbWUgOiAnUmVnaW9uYWwnCiAgICAgIH07CiAgICB9KS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgIHJldHVybiBhLm5hbWUgPiBiLm5hbWUgPyAxIDogLTE7CiAgICB9KTsKICB9LAogIGdldEZlYXR1cmVzOiBmdW5jdGlvbiBnZXRGZWF0dXJlcyhzdGF0ZSkgewogICAgdmFyIGZlYXR1cmVzID0gc3RhdGUuYWxsRmVhdHVyZXM7CgogICAgaWYgKHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmNvdW50cmllcy5sZW5ndGggPiAwKSB7CiAgICAgIGZlYXR1cmVzID0gZmVhdHVyZXMuZmlsdGVyKGZ1bmN0aW9uIChmKSB7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5jb3VudHJ5KSkgewogICAgICAgICAgcmV0dXJuIGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuY291bnRyeS5pbmNsdWRlcyhzdGF0ZS5mZWF0dXJlRmlsdGVycy5jb3VudHJpZXMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICAgICAgICByZXR1cm4gc3RhdGUuZmVhdHVyZUZpbHRlcnMuY291bnRyaWVzLmluY2x1ZGVzKGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuY291bnRyeSkgfHwgZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC5jaXR5ID09PSAnV29ybGQnOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgaWYgKHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmluZGljYXRvcnMubGVuZ3RoID4gMCkgewogICAgICBmZWF0dXJlcyA9IGZlYXR1cmVzLmZpbHRlcihmdW5jdGlvbiAoZikgewogICAgICAgIHJldHVybiBzdGF0ZS5mZWF0dXJlRmlsdGVycy5pbmRpY2F0b3JzLmluY2x1ZGVzKGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuaW5kaWNhdG9yKTsKICAgICAgfSk7CiAgICB9CgogICAgaWYgKCFzdGF0ZS5mZWF0dXJlRmlsdGVycy5pbmNsdWRlQXJjaGl2ZWQpIHsKICAgICAgZmVhdHVyZXMgPSBmZWF0dXJlcy5maWx0ZXIoZnVuY3Rpb24gKGYpIHsKICAgICAgICByZXR1cm4gZi5wcm9wZXJ0aWVzLmluZGljYXRvck9iamVjdC51cGRhdGVGcmVxdWVuY3kgPyBmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LnVwZGF0ZUZyZXF1ZW5jeS50b0xvd2VyQ2FzZSgpICE9PSAnYXJjaGl2ZWQnIDogdHJ1ZTsKICAgICAgfSk7CiAgICB9CgogICAgZmVhdHVyZXMgPSBmZWF0dXJlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgIHJldHVybiBhLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmNvdW50cnkgPiBiLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmNvdW50cnkgPyAxIDogLTE7CiAgICB9KTsKICAgIHJldHVybiBmZWF0dXJlczsKICB9LAogIGdldEdyb3VwZWRGZWF0dXJlczogZnVuY3Rpb24gZ2V0R3JvdXBlZEZlYXR1cmVzKHN0YXRlLCBnZXR0ZXJzLCByb290U3RhdGUpIHsKICAgIHZhciBhbGxGZWF0dXJlcyA9IFtdOwoKICAgIGlmIChzdGF0ZS5hbGxGZWF0dXJlcy5sZW5ndGggPiAwKSB7CiAgICAgIHZhciBncm91cGVkRmVhdHVyZXMgPSBbXTsKCiAgICAgIGlmIChyb290U3RhdGUuY29uZmlnLmFwcENvbmZpZy5mZWF0dXJlR3JvdXBpbmcpIHsKICAgICAgICByb290U3RhdGUuY29uZmlnLmFwcENvbmZpZy5mZWF0dXJlR3JvdXBpbmcuZm9yRWFjaChmdW5jdGlvbiAoZkcpIHsKICAgICAgICAgIHZhciBmaXJzdEZlYXR1cmUgPSBnZXR0ZXJzLmdldEZlYXR1cmVzLmZpbmQoZnVuY3Rpb24gKGYpIHsKICAgICAgICAgICAgcmV0dXJuICIiLmNvbmNhdChmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmFvaUlELCAiLSIpLmNvbmNhdChmLnByb3BlcnRpZXMuaW5kaWNhdG9yT2JqZWN0LmluZGljYXRvcikgPT09IGZHLmZlYXR1cmVzWzBdOwogICAgICAgICAgfSk7CgogICAgICAgICAgaWYgKGZpcnN0RmVhdHVyZSkgewogICAgICAgICAgICBncm91cGVkRmVhdHVyZXMucHVzaChmaXJzdEZlYXR1cmUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgcmVzdEZlYXR1cmVzID0gcm9vdFN0YXRlLmNvbmZpZy5hcHBDb25maWcuZmVhdHVyZUdyb3VwaW5nID8gZ2V0dGVycy5nZXRGZWF0dXJlcy5maWx0ZXIoZnVuY3Rpb24gKGYpIHsKICAgICAgICB2YXIgbG9jYXRpb25Db2RlID0gIiIuY29uY2F0KGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuYW9pSUQsICItIikuY29uY2F0KGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuaW5kaWNhdG9yKTsKICAgICAgICByZXR1cm4gIXJvb3RTdGF0ZS5jb25maWcuYXBwQ29uZmlnLmZlYXR1cmVHcm91cGluZy5maW5kKGZ1bmN0aW9uIChmRykgewogICAgICAgICAgcmV0dXJuIGZHLmZlYXR1cmVzLmluY2x1ZGVzKGxvY2F0aW9uQ29kZSk7CiAgICAgICAgfSk7CiAgICAgIH0pIDogZ2V0dGVycy5nZXRGZWF0dXJlczsKICAgICAgYWxsRmVhdHVyZXMgPSBncm91cGVkRmVhdHVyZXMuY29uY2F0KHJlc3RGZWF0dXJlcyk7CiAgICB9CgogICAgcmV0dXJuIGFsbEZlYXR1cmVzOwogIH0sCiAgZ2V0TGF0ZXN0VXBkYXRlOiBmdW5jdGlvbiBnZXRMYXRlc3RVcGRhdGUoc3RhdGUpIHsKICAgIHZhciB0aW1lcyA9IHN0YXRlLmFsbEZlYXR1cmVzLm1hcChmdW5jdGlvbiAoZikgewogICAgICB2YXIgdGltZSA9IGYucHJvcGVydGllcy5pbmRpY2F0b3JPYmplY3QuVGltZTsKICAgICAgdmFyIGxhdGVzdDsKCiAgICAgIGlmICh0aW1lICYmIHRpbWUubGVuZ3RoID4gMCkgewogICAgICAgIHRpbWUgPSB0aW1lLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgIHJldHVybiBhID4gYiA/IDEgOiAtMTsKICAgICAgICB9KTsKICAgICAgICBsYXRlc3QgPSB0aW1lW3RpbWUubGVuZ3RoIC0gMV07CiAgICAgIH0KCiAgICAgIHJldHVybiBsYXRlc3Q7CiAgICB9KTsKICAgIHZhciBmaWx0ZXJlZCA9IHRpbWVzLmZpbHRlcihmdW5jdGlvbiAodCkgewogICAgICByZXR1cm4gISF0OwogICAgfSkuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gYSA+IGIgPyAxIDogLTE7CiAgICB9KTsKICAgIHJldHVybiBmaWx0ZXJlZFtmaWx0ZXJlZC5sZW5ndGggLSAxXTsKICB9Cn07CnZhciBtdXRhdGlvbnMgPSB7CiAgLy8gU0VUX01BTlVBTF9GRUFUVVJFUyhzdGF0ZSwgZmVhdHVyZXMpIHsKICAvLyAgIHN0YXRlLmFsbEZlYXR1cmVzID0gc3RhdGUuYWxsRmVhdHVyZXMuY29uY2F0KAogIC8vICAgICBmZWF0dXJlcywKICAvLyAgICAgdGhpcy5zdGF0ZS5jb25maWcuYmFzZUNvbmZpZy5nbG9iYWxJbmRpY2F0b3JzLAogIC8vICAgKTsKICAvLyB9LAogIEFERF9ORVdfRkVBVFVSRVM6IGZ1bmN0aW9uIEFERF9ORVdfRkVBVFVSRVMoc3RhdGUsIGZlYXR1cmVzKSB7CiAgICBzdGF0ZS5hbGxGZWF0dXJlcyA9IHN0YXRlLmFsbEZlYXR1cmVzLmNvbmNhdChmZWF0dXJlcyk7CiAgfSwKICAvLyBTRVRfQUxMX0RVTU1ZX0xPQ0FUSU9OUyhzdGF0ZSwgZmVhdHVyZXMpIHsKICAvLyAgIHN0YXRlLmFsbEZlYXR1cmVzID0gc3RhdGUuYWxsRmVhdHVyZXMuY29uY2F0KGZlYXR1cmVzKTsKICAvLyB9LAogIElOSVRfRkVBVFVSRV9GSUxURVI6IGZ1bmN0aW9uIElOSVRfRkVBVFVSRV9GSUxURVIoc3RhdGUsIF9yZWYpIHsKICAgIHZhciBjb3VudHJpZXMgPSBfcmVmLmNvdW50cmllcywKICAgICAgICBpbmRpY2F0b3JzID0gX3JlZi5pbmRpY2F0b3JzOwoKICAgIGlmIChjb3VudHJpZXMpIHsKICAgICAgc3RhdGUuZmVhdHVyZUZpbHRlcnMuY291bnRyaWVzID0gY291bnRyaWVzOwogICAgfQoKICAgIGlmIChpbmRpY2F0b3JzKSB7CiAgICAgIHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmluZGljYXRvcnMgPSBpbmRpY2F0b3JzOwogICAgfQogIH0sCiAgU0VUX0ZFQVRVUkVfRklMVEVSOiBmdW5jdGlvbiBTRVRfRkVBVFVSRV9GSUxURVIoc3RhdGUsIG9wdGlvbnMpIHsKICAgIGlmICghb3B0aW9ucykgcmV0dXJuOwoKICAgIHZhciBoYXNGZWF0dXJlID0gZnVuY3Rpb24gaGFzRmVhdHVyZShmKSB7CiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhvcHRpb25zKS5pbmNsdWRlcyhmKTsKICAgIH07CgogICAgaWYgKGhhc0ZlYXR1cmUoJ2NvdW50cmllcycpKSB7CiAgICAgIHN0YXRlLmZlYXR1cmVGaWx0ZXJzLmNvdW50cmllcyA9IG9wdGlvbnMuY291bnRyaWVzOwogICAgfQoKICAgIGlmIChoYXNGZWF0dXJlKCdpbmRpY2F0b3JzJykpIHsKICAgICAgc3RhdGUuZmVhdHVyZUZpbHRlcnMuaW5kaWNhdG9ycyA9IG9wdGlvbnMuaW5kaWNhdG9yczsKICAgIH0KCiAgICBpZiAoaGFzRmVhdHVyZSgnaW5jbHVkZUFyY2hpdmVkJykpIHsKICAgICAgc3RhdGUuZmVhdHVyZUZpbHRlcnMuaW5jbHVkZUFyY2hpdmVkID0gb3B0aW9ucy5pbmNsdWRlQXJjaGl2ZWQ7CiAgICB9CiAgfSwKICBBRERfUkVTVUxUU19DT1VOVDogZnVuY3Rpb24gQUREX1JFU1VMVFNfQ09VTlQoc3RhdGUsIF9yZWYyKSB7CiAgICB2YXIgdHlwZSA9IF9yZWYyLnR5cGUsCiAgICAgICAgY291bnQgPSBfcmVmMi5jb3VudDsKICAgIHN0YXRlLnJlc3VsdHNDb3VudFt0eXBlXSArPSBjb3VudDsKICB9LAogIFNFVF9TRUxFQ1RFRF9BUkVBOiBmdW5jdGlvbiBTRVRfU0VMRUNURURfQVJFQShzdGF0ZSwgYXJlYSkgewogICAgc3RhdGUuc2VsZWN0ZWRBcmVhID0gYXJlYTsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIGxvYWRBbGxFbmRwb2ludHM6IGZ1bmN0aW9uIGxvYWRBbGxFbmRwb2ludHMoX3JlZjMpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGNvbW1pdCwgcm9vdFN0YXRlLCBhbGxGZWF0dXJlcywgZW5kcG9pbnRzLCBlcCwgdXJsLCBGLCBlbmRQb2ludElkeCwgZHVtbXlGZWF0dXJlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYzLmNvbW1pdCwgcm9vdFN0YXRlID0gX3JlZjMucm9vdFN0YXRlOwogICAgICAgICAgICAgIGFsbEZlYXR1cmVzID0gW107CiAgICAgICAgICAgICAgZW5kcG9pbnRzID0gcm9vdFN0YXRlLmNvbmZpZy5iYXNlQ29uZmlnLmRhdGFFbmRwb2ludHM7CiAgICAgICAgICAgICAgZXAgPSAwOwoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGlmICghKGVwIDwgZW5kcG9pbnRzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZW5kcG9pbnRzW2VwXSwgJ3R5cGUnKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIzOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB1cmwgPSBlbmRwb2ludHNbZXBdLnByb3ZpZGVyOwoKICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGVuZHBvaW50c1tlcF0sICdsb2NhdGlvblN1ZmZpeCcpKSB7CiAgICAgICAgICAgICAgICB1cmwgKz0gZW5kcG9pbnRzW2VwXS5sb2NhdGlvblN1ZmZpeDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIEYgPSB2b2lkIDA7CiAgICAgICAgICAgICAgZW5kUG9pbnRJZHggPSBlcDsKICAgICAgICAgICAgICBfY29udGV4dC50MCA9IGVuZHBvaW50c1tlcF0udHlwZTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gX2NvbnRleHQudDAgPT09ICdnZW9kYicgPyAxMyA6IF9jb250ZXh0LnQwID09PSAnZW94JyA/IDE3IDogMjE7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZGlzcGF0Y2goIC8vIGVzbGludC1kaXNhYmxlLWxpbmUKICAgICAgICAgICAgICAnZmVhdHVyZXMvbG9hZEdlb0RCRW5kcG9pbnQnLCB7CiAgICAgICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgICAgIGVuZFBvaW50SWR4OiBlbmRQb2ludElkeAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBGID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJicmVhayIsIDIyKTsKCiAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE5OwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5kaXNwYXRjaCggLy8gZXNsaW50LWRpc2FibGUtbGluZQogICAgICAgICAgICAgICdmZWF0dXJlcy9sb2FkRU9YRW5kcG9pbnQnLCB7CiAgICAgICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgICAgIGVuZFBvaW50SWR4OiBlbmRQb2ludElkeAogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICBGID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJicmVhayIsIDIyKTsKCiAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0VuZHBvaW50IHR5cGUgdW5rbm93bicpOwoKICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICBhbGxGZWF0dXJlcyA9IGFsbEZlYXR1cmVzLmNvbmNhdChGKTsKCiAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgZXAgKz0gMTsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgICAgLy8gVGhlbiwgYWRkIHRoZSBoYXJkY29kZWQgZmVhdHVyZXMKICAgICAgICAgICAgICBhbGxGZWF0dXJlcyA9IGFsbEZlYXR1cmVzLmNvbmNhdChyb290U3RhdGUuY29uZmlnLmJhc2VDb25maWcuZ2xvYmFsSW5kaWNhdG9ycyk7IC8vIFRoZW4sIGlmIGFwcGxpY2FibGUsIGFkZCB0aGUgZHVtbXkgZmVhdHVyZXMKCiAgICAgICAgICAgICAgaWYgKCFyb290U3RhdGUuY29uZmlnLmFwcENvbmZpZy5kaXNwbGF5RHVtbXlMb2NhdGlvbnMpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5kaXNwYXRjaCgnZmVhdHVyZXMvbG9hZER1bW15TG9jYXRpb25zJyk7CgogICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgIGR1bW15RmVhdHVyZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIGFsbEZlYXR1cmVzID0gYWxsRmVhdHVyZXMuY29uY2F0KGR1bW15RmVhdHVyZXMpOwoKICAgICAgICAgICAgY2FzZSAzMjoKICAgICAgICAgICAgICBjb21taXQoJ0FERF9ORVdfRkVBVFVSRVMnLCBhbGxGZWF0dXJlcyk7CgogICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSgpOwogIH0sCiAgbG9hZEVPWEVuZHBvaW50OiBmdW5jdGlvbiBsb2FkRU9YRW5kcG9pbnQoX3JlZjQsIF9yZWY1KSB7CiAgICB2YXIgcm9vdFN0YXRlID0gX3JlZjQucm9vdFN0YXRlLAogICAgICAgIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgIHZhciB1cmwgPSBfcmVmNS51cmwsCiAgICAgICAgZW5kUG9pbnRJZHggPSBfcmVmNS5lbmRQb2ludElkeDsKICAgIHJldHVybiBmZXRjaCh1cmwsIHsKICAgICAgY3JlZGVudGlhbHM6ICdzYW1lLW9yaWdpbicKICAgIH0pLnRoZW4oZnVuY3Rpb24gKHIpIHsKICAgICAgcmV0dXJuIHIuanNvbigpOwogICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICB2YXIgZmVhdHVyZXMgPSBbXTsKICAgICAgdmFyIHBNID0gewogICAgICAgIGFvaTogJ2FvaScsCiAgICAgICAgYW9pSUQ6ICdhb2lJRCcsCiAgICAgICAgbGFzdENvbG9yQ29kZTogJ2xhc3RDb2xvckNvZGUnLAogICAgICAgIGNvdW50cnk6ICdjb3VudHJ5JywKICAgICAgICBpbmRpY2F0b3I6ICdpbmRpY2F0b3InLAogICAgICAgIGxhc3RJbmRpY2F0b3JWYWx1ZTogJ2xhc3RJbmRpY2F0b3JWYWx1ZScsCiAgICAgICAgbGFzdFRpbWU6ICdsYXN0VGltZScsCiAgICAgICAgbGFzdE1lYXN1cmVtZW50OiAnbGFzdE1lYXN1cmVtZW50JywKICAgICAgICBzaXRlTmFtZTogJ3NpdGVOYW1lJywKICAgICAgICBzdWJBb2k6ICdzdWJBb2knLAogICAgICAgIGNpdHk6ICdjaXR5JywKICAgICAgICBkZXNjcmlwdGlvbjogJ2Rlc2NyaXB0aW9uJywKICAgICAgICByZWdpb246ICdyZWdpb24nLAogICAgICAgIGluZGljYXRvck5hbWU6ICdpbmRpY2F0b3JOYW1lJywKICAgICAgICBsYXN0UmVmZXJlbmNlVmFsdWU6ICdsYXN0UmVmZXJlbmNlVmFsdWUnLAogICAgICAgIGxhc3RSZWZlcmVuY2VUaW1lOiAnbGFzdFJlZmVyZW5jZVRpbWUnLAogICAgICAgIHlBeGlzOiAneUF4aXMnLAogICAgICAgIHVwZGF0ZUZyZXF1ZW5jeTogJ3VwZGF0ZUZyZXF1ZW5jeScKICAgICAgfTsKICAgICAgY29tbWl0KCdBRERfUkVTVUxUU19DT1VOVCcsIHsKICAgICAgICB0eXBlOiByb290U3RhdGUuY29uZmlnLmJhc2VDb25maWcuaW5kaWNhdG9yc0RlZmluaXRpb25bZGF0YVswXVtwTS5pbmRpY2F0b3JdXS5jbGFzcywKICAgICAgICBjb3VudDogZGF0YS5sZW5ndGggLy8gaW5kaXZpZHVhbCBtZWFzdXJlbWVudHMKCiAgICAgIH0pOyAvLyBvbmx5IGNvbnRpbnVlIGlmIGFvaSBjb2x1bW4gaXMgcHJlc2VudAoKICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhWzBdLCBwTS5hb2kpKSB7CiAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB3a3QgPSBuZXcgV2t0KCk7CiAgICAgICAgICB2YXIgZmVhdHVyZU9ianMgPSB7fTsKCiAgICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChycikgewogICAgICAgICAgICAvLyBBZ2dyZWdhdGUgZGF0YSBiYXNlZCBvbiBsb2NhdGlvbgogICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gIiIuY29uY2F0KGRhdGFbcnJdW3BNLmFvaV0sICJfIikuY29uY2F0KGRhdGFbcnJdW3BNLmluZGljYXRvcl0pOwoKICAgICAgICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZmVhdHVyZU9ianMsIHVuaXF1ZUtleSkpIHsKICAgICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldID0ge307CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gVGhpcyBzaG91bGQgbm90IGhhcHBlbgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJXQVJOSU5HOiBEdXBsaWNhdGUgdW5pcXVlS2V5ICIuY29uY2F0KHVuaXF1ZUtleSwgIiBpbiByZXRyaWV2ZWQgZGF0YS4iKSk7CiAgICAgICAgICAgIH0gLy8gQ3JlYXRlIG5ldyBvYmplY3Qgd2l0aCBtYXBwZWQga2V5cyB0byBhbGxvdyBpbnRlZ3JhdGluZyBkYXRhCiAgICAgICAgICAgIC8vIG9mIG11bHRpcGxlIGVuZHBvaW50cwoKCiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHBNKS5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmNikgewogICAgICAgICAgICAgIHZhciBfcmVmNyA9IF9zbGljZWRUb0FycmF5KF9yZWY2LCAyKSwKICAgICAgICAgICAgICAgICAga2V5ID0gX3JlZjdbMF0sCiAgICAgICAgICAgICAgICAgIHZhbHVlID0gX3JlZjdbMV07CgogICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGF0YVtycl0sIHZhbHVlKSkgewogICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3N1YkFvaScpIHsKICAgICAgICAgICAgICAgICAgLy8gZHVtbXkgZW1wdHkgZ2VvbWV0cnkKICAgICAgICAgICAgICAgICAgdmFyIGZ0cnMgPSBbXTsKCiAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgLy8gYXNzdW1pbmcgc3ViLWFvaSBkb2VzIG5vdCBjaGFuZ2Ugb3ZlciB0aW1lCiAgICAgICAgICAgICAgICAgICAgaWYgKCFbJycsICcvJ10uaW5jbHVkZXMoZGF0YVtycl1bdmFsdWVdKSkgewogICAgICAgICAgICAgICAgICAgICAgd2t0LnJlYWQoZGF0YVtycl1bdmFsdWVdKTsKICAgICAgICAgICAgICAgICAgICAgIHZhciBqc29uR2VvbSA9IHdrdC50b0pzb24oKTsgLy8gY3JlYXRlIGEgZmVhdHVyZSBjb2xsZWN0aW9uCgogICAgICAgICAgICAgICAgICAgICAgZnRycyA9IFt7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlJywKICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge30sCiAgICAgICAgICAgICAgICAgICAgICAgIGdlb21ldHJ5OiBqc29uR2VvbQogICAgICAgICAgICAgICAgICAgICAgfV07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgcGFyc2luZyBzdWJBb2kgb2YgbG9jYXRpb25zIGZvciBpbmRleCAiLmNvbmNhdChycikpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB2YXIgZnRyQ29sID0gewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXM6IGZ0cnMKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgZmVhdHVyZU9ianNbdW5pcXVlS2V5XVtrZXldID0gZnRyQ29sOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09ICdsYXN0TWVhc3VyZW1lbnQnKSB7CiAgICAgICAgICAgICAgICAgIGZlYXR1cmVPYmpzW3VuaXF1ZUtleV1ba2V5XSA9IGRhdGFbcnJdW3ZhbHVlXS5sZW5ndGggIT09IDAgPyBOdW1iZXIoZGF0YVtycl1bdmFsdWVdKSA6IE5hTjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGZlYXR1cmVPYmpzW3VuaXF1ZUtleV1ba2V5XSA9IGRhdGFbcnJdW3ZhbHVlXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfTsKCiAgICAgICAgICBmb3IgKHZhciByciA9IDA7IHJyIDwgZGF0YS5sZW5ndGg7IHJyICs9IDEpIHsKICAgICAgICAgICAgX2xvb3AocnIpOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZmVhdHVyZU9ianMpOwoKICAgICAgICAgIGZvciAodmFyIGtrID0gMDsga2sgPCBrZXlzLmxlbmd0aDsga2sgKz0gMSkgewogICAgICAgICAgICB2YXIgY29vcmRzID0ga2V5c1tra10uc3BsaXQoJ18nKVswXS5yZXBsYWNlKCcgJywgJycpLnNwbGl0KCcsJykubWFwKE51bWJlcik7CiAgICAgICAgICAgIGZlYXR1cmVPYmpzW2tleXNba2tdXS5hb2kgPSBsYXRMbmcoW2Nvb3Jkc1swXSwgY29vcmRzWzFdXSk7CiAgICAgICAgICAgIGZlYXR1cmVPYmpzW2tleXNba2tdXS5pZCA9IGdsb2JhbElkQ291bnRlcjsgLy8gdG8gY29ubmVjdCBpbmRpY2F0b3IgJiBmZWF0dXJlCgogICAgICAgICAgICBmZWF0dXJlT2Jqc1trZXlzW2trXV0uZW5kUG9pbnRJZHggPSBlbmRQb2ludElkeDsKICAgICAgICAgICAgZmVhdHVyZXMucHVzaCh7CiAgICAgICAgICAgICAgbGF0bG5nOiBsYXRMbmcoW2Nvb3Jkc1swXSwgY29vcmRzWzFdXSksCiAgICAgICAgICAgICAgaWQ6IGdsb2JhbElkQ291bnRlciwKICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICBpbmRpY2F0b3JPYmplY3Q6IGZlYXR1cmVPYmpzW2tleXNba2tdXQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGdsb2JhbElkQ291bnRlciArPSAxOwogICAgICAgICAgfQogICAgICAgIH0pKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmZWF0dXJlczsKICAgIH0pOwogIH0sCiAgbG9hZEdlb0RCRW5kcG9pbnQ6IGZ1bmN0aW9uIGxvYWRHZW9EQkVuZHBvaW50KF9yZWY4LCBfcmVmOSkgewogICAgdmFyIHJvb3RTdGF0ZSA9IF9yZWY4LnJvb3RTdGF0ZSwKICAgICAgICBjb21taXQgPSBfcmVmOC5jb21taXQ7CiAgICB2YXIgdXJsID0gX3JlZjkudXJsLAogICAgICAgIGVuZFBvaW50SWR4ID0gX3JlZjkuZW5kUG9pbnRJZHg7CiAgICByZXR1cm4gZmV0Y2godXJsLCB7CiAgICAgIGNyZWRlbnRpYWxzOiAnc2FtZS1vcmlnaW4nCiAgICB9KS50aGVuKGZ1bmN0aW9uIChyKSB7CiAgICAgIHJldHVybiByLmpzb24oKTsKICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgdmFyIGZlYXR1cmVzID0gW107CiAgICAgIHZhciBwTSA9IHsKICAgICAgICBhb2k6ICdhb2knLAogICAgICAgIGFvaUlEOiAnYW9pX2lkJywKICAgICAgICBsYXN0Q29sb3JDb2RlOiAnY29sb3JfY29kZScsCiAgICAgICAgY291bnRyeTogJ2NvdW50cnknLAogICAgICAgIGdlb21ldHJ5OiAnZ2VvbWV0cnknLAogICAgICAgIGluZGljYXRvcjogJ2luZGljYXRvcl9jb2RlJywKICAgICAgICBsYXN0SW5kaWNhdG9yVmFsdWU6ICdpbmRpY2F0b3JfdmFsdWUnLAogICAgICAgIGxhc3RUaW1lOiAnbWF4X3RpbWUnLAogICAgICAgIGxhc3RNZWFzdXJlbWVudDogJ21lYXN1cmVtZW50X3ZhbHVlJywKICAgICAgICBzaXRlTmFtZTogJ3NpdGVfbmFtZScsCiAgICAgICAgc3ViQW9pOiAnc3ViX2FvaScKICAgICAgICAvKgogICAgICAgIGNpdHk6ICdjaXR5JywKICAgICAgICBkZXNjcmlwdGlvbjogJ2Rlc2NyaXB0aW9uJywKICAgICAgICBpbmRpY2F0b3JOYW1lOiAnSW5kaWNhdG9yIE5hbWUnLCAvLyBub3QgcHJlc2VudAogICAgICAgIGxhc3RSZWZlcmVuY2VUaW1lOiAncmVmZXJlbmNlIGRhdGUgdGltZSBbeXl5eS1tbS1kZHRoaDptbTpzc10nLAogICAgICAgIGxhc3RSZWZlcmVuY2VWYWx1ZTogJ3JlZmVyZW5jZSB2YWx1ZSBbZmxvYXRdJywKICAgICAgICByZWdpb246ICdyZWdpb24gKG9wdGlvbmFsKScsCiAgICAgICAgdXBkYXRlRnJlcXVlbmN5OiAndXBkYXRlIGZyZXF1ZW5jeScsIC8vIG5vdCBwcmVzZW50CiAgICAgICAgLy8gUHJvYmFibHkgbm90IG5lZWRlZCBpbiBvdmVydmlldwogICAgICAgIHJlZmVyZW5jZURlc2NyaXB0aW9uOiAncmVmZXJlbmNlIGRlc2NyaXB0aW9uJywKICAgICAgICBtZXRob2Q6ICdtZXRob2QnLAogICAgICAgIHJ1bGU6ICdydWxlJywKICAgICAgICBlb1NlbnNvcjogJ2VvIHNlbnNvcicsCiAgICAgICAgaW5wdXREYXRhOiAnaW5wdXQgZGF0YScsCiAgICAgICAgKi8KCiAgICAgIH07CiAgICAgIGNvbW1pdCgnQUREX1JFU1VMVFNfQ09VTlQnLCB7CiAgICAgICAgdHlwZTogcm9vdFN0YXRlLmNvbmZpZy5iYXNlQ29uZmlnLmluZGljYXRvcnNEZWZpbml0aW9uW2RhdGFbMF1bcE0uaW5kaWNhdG9yXV0uY2xhc3MsCiAgICAgICAgY291bnQ6IGRhdGEubGVuZ3RoIC8vIGluZGl2aWR1YWwgbWVhc3VyZW1lbnRzCgogICAgICB9KTsgLy8gb25seSBjb250aW51ZSBpZiBhb2kgY29sdW1uIGlzIHByZXNlbnQKCiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGF0YVswXSwgcE0uYW9pKSkgewogICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgd2t0ID0gbmV3IFdrdCgpOwogICAgICAgICAgdmFyIGZlYXR1cmVPYmpzID0ge307CgogICAgICAgICAgdmFyIF9sb29wMiA9IGZ1bmN0aW9uIF9sb29wMihycikgewogICAgICAgICAgICAvLyBBZ2dyZWdhdGUgZGF0YSBiYXNlZCBvbiBsb2NhdGlvbgogICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gIiIuY29uY2F0KGRhdGFbcnJdW3BNLmFvaV0sICJfIikuY29uY2F0KGRhdGFbcnJdW3BNLmluZGljYXRvcl0pOwoKICAgICAgICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZmVhdHVyZU9ianMsIHVuaXF1ZUtleSkpIHsKICAgICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldID0ge307IC8vIFRPRE86IFJlbW92ZSBwbGFjZWhvbGRlciB0ZXh0CgogICAgICAgICAgICAgIGZlYXR1cmVPYmpzW3VuaXF1ZUtleV0uZGVzY3JpcHRpb24gPSAncGxhY2Vob2xkZXIgZGVzY3JpcHRpb24nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCBoYXBwZW4KICAgICAgICAgICAgICBjb25zb2xlLmxvZygiV0FSTklORzogRHVwbGljYXRlIHVuaXF1ZUtleSAiLmNvbmNhdCh1bmlxdWVLZXksICIgaW4gcmV0cmlldmVkIGRhdGEuIikpOwogICAgICAgICAgICB9IC8vIENyZWF0ZSBuZXcgb2JqZWN0IHdpdGggbWFwcGVkIGtleXMgdG8gYWxsb3cgaW50ZWdyYXRpbmcgZGF0YQogICAgICAgICAgICAvLyBvZiBtdWx0aXBsZSBlbmRwb2ludHMKCgogICAgICAgICAgICBPYmplY3QuZW50cmllcyhwTSkuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjEwKSB7CiAgICAgICAgICAgICAgdmFyIF9yZWYxMSA9IF9zbGljZWRUb0FycmF5KF9yZWYxMCwgMiksCiAgICAgICAgICAgICAgICAgIGtleSA9IF9yZWYxMVswXSwKICAgICAgICAgICAgICAgICAgdmFsdWUgPSBfcmVmMTFbMV07CgogICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGF0YVtycl0sIHZhbHVlKSkgewogICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gJ3N1YkFvaScpIHsKICAgICAgICAgICAgICAgICAgLy8gZHVtbXkgZW1wdHkgZ2VvbWV0cnkKICAgICAgICAgICAgICAgICAgdmFyIGZ0cnMgPSBbXTsKCiAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgLy8gYXNzdW1pbmcgc3ViLWFvaSBkb2VzIG5vdCBjaGFuZ2Ugb3ZlciB0aW1lCiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbcnJdW3ZhbHVlXSAhPT0gJycpIHsKICAgICAgICAgICAgICAgICAgICAgIHdrdC5yZWFkKGRhdGFbcnJdW3ZhbHVlXSk7CiAgICAgICAgICAgICAgICAgICAgICB2YXIganNvbkdlb20gPSB3a3QudG9Kc29uKCk7IC8vIGNyZWF0ZSBhIGZlYXR1cmUgY29sbGVjdGlvbgoKICAgICAgICAgICAgICAgICAgICAgIGZ0cnMgPSBbewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHt9LAogICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyeToganNvbkdlb20KICAgICAgICAgICAgICAgICAgICAgIH1dOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIHBhcnNpbmcgc3ViQW9pIG9mIGxvY2F0aW9ucyBmb3IgaW5kZXggIi5jb25jYXQocnIpKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdmFyIGZ0ckNvbCA9IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzOiBmdHJzCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgIGZlYXR1cmVPYmpzW3VuaXF1ZUtleV1ba2V5XSA9IGZ0ckNvbDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAnbGFzdE1lYXN1cmVtZW50JykgewogICAgICAgICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldW2tleV0gPSBkYXRhW3JyXVt2YWx1ZV0ubGVuZ3RoICE9PSAwID8gTnVtYmVyKGRhdGFbcnJdW3ZhbHVlXSkgOiBOYU47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldW2tleV0gPSBkYXRhW3JyXVt2YWx1ZV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH07CgogICAgICAgICAgZm9yICh2YXIgcnIgPSAwOyByciA8IGRhdGEubGVuZ3RoOyByciArPSAxKSB7CiAgICAgICAgICAgIF9sb29wMihycik7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhmZWF0dXJlT2Jqcyk7CgogICAgICAgICAgZm9yICh2YXIga2sgPSAwOyBrayA8IGtleXMubGVuZ3RoOyBrayArPSAxKSB7CiAgICAgICAgICAgIHZhciBjb29yZHMgPSBrZXlzW2trXS5zcGxpdCgnXycpWzBdLnJlcGxhY2UoJ1BPSU5UKCcsICcnKS5yZXBsYWNlKCcpJywgJycpLnNwbGl0KCcgJykubWFwKE51bWJlcik7CiAgICAgICAgICAgIGZlYXR1cmVPYmpzW2tleXNba2tdXS5hb2kgPSBsYXRMbmcoW2Nvb3Jkc1sxXSwgY29vcmRzWzBdXSk7CiAgICAgICAgICAgIGZlYXR1cmVPYmpzW2tleXNba2tdXS5pZCA9IGdsb2JhbElkQ291bnRlcjsgLy8gdG8gY29ubmVjdCBpbmRpY2F0b3IgJiBmZWF0dXJlCgogICAgICAgICAgICBmZWF0dXJlT2Jqc1trZXlzW2trXV0uZW5kUG9pbnRJZHggPSBlbmRQb2ludElkeDsKICAgICAgICAgICAgZmVhdHVyZXMucHVzaCh7CiAgICAgICAgICAgICAgbGF0bG5nOiBsYXRMbmcoW2Nvb3Jkc1sxXSwgY29vcmRzWzBdXSksCiAgICAgICAgICAgICAgaWQ6IGdsb2JhbElkQ291bnRlciwKICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICBpbmRpY2F0b3JPYmplY3Q6IGZlYXR1cmVPYmpzW2tleXNba2tdXQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGdsb2JhbElkQ291bnRlciArPSAxOwogICAgICAgICAgfQogICAgICAgIH0pKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmZWF0dXJlczsKICAgIH0pOwogIH0sCiAgbG9hZER1bW15TG9jYXRpb25zOiBmdW5jdGlvbiBsb2FkRHVtbXlMb2NhdGlvbnMoX3JlZjEyKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICB2YXIgcm9vdFN0YXRlID0gX3JlZjEyLnJvb3RTdGF0ZTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICBfdGhpczIuX3ZtLiRwYXBhLnBhcnNlKHJvb3RTdGF0ZS5jb25maWcuYXBwQ29uZmlnLmRpc3BsYXlEdW1teUxvY2F0aW9ucywgewogICAgICAgIGRvd25sb2FkOiB0cnVlLAogICAgICAgIHF1b3RlczogdHJ1ZSwKICAgICAgICBoZWFkZXI6IHRydWUsCiAgICAgICAgc2tpcEVtcHR5TGluZXM6IHRydWUsCiAgICAgICAgZGVsaW1pdGVyOiAnLCcsCiAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uIGNvbXBsZXRlKHJlc3VsdCkgewogICAgICAgICAgdmFyIGRhdGEgPSByZXN1bHQuZGF0YTsKICAgICAgICAgIHZhciBmZWF0dXJlT2JqcyA9IHt9OwoKICAgICAgICAgIGZvciAodmFyIHJyID0gMDsgcnIgPCBkYXRhLmxlbmd0aDsgcnIgKz0gMSkgewogICAgICAgICAgICB2YXIgdW5pcXVlS2V5ID0gIiIuY29uY2F0KGRhdGFbcnJdLmFvaSwgIl9kIik7CiAgICAgICAgICAgIGZlYXR1cmVPYmpzW3VuaXF1ZUtleV0gPSBkYXRhW3JyXTsKICAgICAgICAgICAgZmVhdHVyZU9ianNbdW5pcXVlS2V5XS5pbmRpY2F0b3IgPSAnZCc7CiAgICAgICAgICAgIGZlYXR1cmVPYmpzW3VuaXF1ZUtleV0uaW5kaWNhdG9yVmFsdWUgPSBbJyddOwogICAgICAgICAgICBmZWF0dXJlT2Jqc1t1bmlxdWVLZXldLmR1bW15RmVhdHVyZSA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGZlYXR1cmVzID0gW107CiAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGZlYXR1cmVPYmpzKTsKCiAgICAgICAgICBmb3IgKHZhciBrayA9IDA7IGtrIDwga2V5cy5sZW5ndGg7IGtrICs9IDEpIHsKICAgICAgICAgICAgdmFyIGNvb3JkaW5hdGVzID0ga2V5c1tra10uc3BsaXQoJ18nKVswXS5zcGxpdCgnLCcpLm1hcChOdW1iZXIpOwogICAgICAgICAgICBmZWF0dXJlT2Jqc1trZXlzW2trXV0uaWQgPSBnbG9iYWxJZENvdW50ZXI7IC8vIHRvIGNvbm5lY3QgaW5kaWNhdG9yICYgZmVhdHVyZQoKICAgICAgICAgICAgZmVhdHVyZXMucHVzaCh7CiAgICAgICAgICAgICAgbGF0bG5nOiBsYXRMbmcoY29vcmRpbmF0ZXMpLAogICAgICAgICAgICAgIGlkOiBnbG9iYWxJZENvdW50ZXIsCiAgICAgICAgICAgICAgcHJvcGVydGllczogewogICAgICAgICAgICAgICAgaW5kaWNhdG9yT2JqZWN0OiBmZWF0dXJlT2Jqc1trZXlzW2trXV0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBnbG9iYWxJZENvdW50ZXIgKz0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXNvbHZlKGZlYXR1cmVzKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgZ2V0dGVyczogZ2V0dGVycywKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zCn07"},null]}